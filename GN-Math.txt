data://text/html;charset=utf-8;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICAgIDxoZWFkPgogICAgICAgIDxiYXNlIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2duLW1hdGgtRE9OVERNQ0FAbWFpbi8iPgoKICAgIDxsaW5rIHJlbD0iaWNvbiIgdHlwZT0iaW1hZ2UvcG5nIiBocmVmPSJmYXZpY29uLnBuZyI+CiAgICA8bGluayByZWw9Imljb24iIHR5cGU9ImltYWdlL3BuZyIgc2l6ZXM9IjMyeDMyIiBocmVmPSJmYXZpY29uLnBuZyI+CiAgICA8bGluayByZWw9ImFwcGxlLXRvdWNoLWljb24iIGhyZWY9ImZhdmljb24ucG5nIj4KICAgIDxzY3JpcHQ+CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9ICcnOwogICAgICAgICAgICByZXR1cm4gJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBsZWF2ZT8gQW55IHVuc2F2ZWQgY2hhbmdlcyB3aWxsIGJlIGxvc3QuJzsKICAgICAgICB9KTsKICAgIDwvc2NyaXB0PgogICAgPHNjcmlwdCBhc3luYz0iIiBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9Ry1XWDVWUzU0WkRXIj48L3NjcmlwdD4KICAgIDxzY3JpcHQ+CiAgICAgICAgd2luZG93LmRhdGFMYXllciA9IHdpbmRvdy5kYXRhTGF5ZXIgfHwgW107CgogICAgICAgIGZ1bmN0aW9uIGd0YWcoKSB7CiAgICAgICAgICAgIGRhdGFMYXllci5wdXNoKGFyZ3VtZW50cyk7CiAgICAgICAgfQogICAgICAgIGd0YWcoJ2pzJywgbmV3IERhdGUoKSk7CiAgICAgICAgZ3RhZygnY29uZmlnJywgJ0ctV1g1VlM1NFpEVycpOwogICAgPC9zY3JpcHQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+Z24tbWF0aDwvdGl0bGU+CiAgICA8bWV0YSBuYW1lPSJ0aXRsZSIgY29udGVudD0iR04tTWF0aCI+CiAgICA8bWV0YSBuYW1lPSJkZXNjcmlwdGlvbiIgY29udGVudD0iUGxheSB1bmJsKmNrZWQgZ2FtZXMgbGlrZSBDcmF6eSBDYXR0bGUgM0QgYW5kIERyaXZlTWFkIG9uIEdOLU1hdGguIEZhc3QsIGZyZWUsIG5vIGRvd25sb2Fkc+KAlHBlcmZlY3QgZm9yIHNjaG9vbCBvciBob21lLiI+CiAgICA8bWV0YSBwcm9wZXJ0eT0ib2c6dHlwZSIgY29udGVudD0id2Vic2l0ZSI+CiAgICA8bWV0YSBwcm9wZXJ0eT0ib2c6dXJsIiBjb250ZW50PSJodHRwczovL2duLW1hdGguZ2l0aHViLmlvLyI+CiAgICA8bWV0YSBwcm9wZXJ0eT0ib2c6dGl0bGUiIGNvbnRlbnQ9IkdOLU1hdGgiPgogICAgPG1ldGEgcHJvcGVydHk9Im9nOmRlc2NyaXB0aW9uIiBjb250ZW50PSJQbGF5IHVuYmwqY2tlZCBnYW1lcyBsaWtlIENyYXp5IENhdHRsZSAzRCBhbmQgRHJpdmVNYWQgb24gR04tTWF0aC4gRmFzdCwgZnJlZSwgbm8gZG93bmxvYWRz4oCUcGVyZmVjdCBmb3Igc2Nob29sIG9yIGhvbWUuIj4KICAgIDxtZXRhIG5hbWU9InR3aXR0ZXI6Y2FyZCIgY29udGVudD0ic3VtbWFyeV9sYXJnZV9pbWFnZSI+CiAgICA8bWV0YSBuYW1lPSJ0d2l0dGVyOnVybCIgY29udGVudD0iaHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pby8iPgogICAgPG1ldGEgbmFtZT0idHdpdHRlcjp0aXRsZSIgY29udGVudD0iR04tTWF0aCI+CiAgICA8bWV0YSBuYW1lPSJ0d2l0dGVyOmRlc2NyaXB0aW9uIiBjb250ZW50PSJQbGF5IHVuYmwqY2tlZCBnYW1lcyBsaWtlIENyYXp5IENhdHRsZSAzRCBhbmQgRHJpdmVNYWQgb24gR04tTWF0aC4gRmFzdCwgZnJlZSwgbm8gZG93bmxvYWRz4oCUcGVyZmVjdCBmb3Igc2Nob29sIG9yIGhvbWUuIj4KICAgIDxzdHlsZT4KICAgICAgICA6cm9vdCB7CiAgICAtLXByaW1hcnk6ICNmYzI2NTE7CiAgICAtLXByaW1hcnktaG92ZXI6ICNlOTFlNDc7CiAgICAtLXByaW1hcnktbGlnaHQ6IHJnYmEoMjUyLCAzOCwgODEsIDAuMSk7CiAgICAtLXByaW1hcnktbGlnaHRlcjogcmdiYSgyNTIsIDM4LCA4MSwgMC4wNSk7CiAgICAtLWFjY2VudDogIzhiNWNmNjsKICAgIC0tYWNjZW50LWxpZ2h0OiByZ2JhKDEzOSwgOTIsIDI0NiwgMC4xKTsKICAgIC0tc3VjY2VzczogIzEwYjk4MTsKICAgIC0td2FybmluZzogI2Y1OWUwYjsKICAgIC0tdGV4dDogIzFhMWExYTsKICAgIC0tdGV4dC1tdXRlZDogIzZiNzI4MDsKICAgIC0tdGV4dC1saWdodDogIzljYTNhZjsKICAgIC0tYmc6ICNmZmZmZmY7CiAgICAtLWJnLXNlY29uZGFyeTogI2Y4ZmFmYzsKICAgIC0tc3VyZmFjZTogI2ZmZmZmZjsKICAgIC0tc3VyZmFjZS1ob3ZlcjogI2YxZjVmOTsKICAgIC0tYm9yZGVyOiAjZTJlOGYwOwogICAgLS1ib3JkZXItbGlnaHQ6ICNmMWY1Zjk7CiAgICAtLWdsYXNzOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCk7CiAgICAtLXNoYWRvdy14czogMCAxcHggMnB4IDAgcmdiKDAgMCAwIC8gMC4wNSk7CiAgICAtLXNoYWRvdy1zbTogMCAxcHggM3B4IDAgcmdiKDAgMCAwIC8gMC4xKSwgMCAxcHggMnB4IC0xcHggcmdiKDAgMCAwIC8gMC4xKTsKICAgIC0tc2hhZG93OiAwIDRweCA2cHggLTFweCByZ2IoMCAwIDAgLyAwLjEpLCAwIDJweCA0cHggLTJweCByZ2IoMCAwIDAgLyAwLjEpOwogICAgLS1zaGFkb3ctbGc6IDAgMTBweCAxNXB4IC0zcHggcmdiKDAgMCAwIC8gMC4xKSwgMCA0cHggNnB4IC00cHggcmdiKDAgMCAwIC8gMC4xKTsKICAgIC0tc2hhZG93LXhsOiAwIDIwcHggMjVweCAtNXB4IHJnYigwIDAgMCAvIDAuMSksIDAgOHB4IDEwcHggLTZweCByZ2IoMCAwIDAgLyAwLjEpOwogICAgLS1zaGFkb3ctZ2xvdzogMCAwIDIwcHggcmdiYSgyNTIsIDM4LCA4MSwgMC4zKTsKICAgIC0tcmFkaXVzOiAxMnB4OwogICAgLS1yYWRpdXMtc206IDhweDsKICAgIC0tcmFkaXVzLWxnOiAxNnB4OwogICAgLS1yYWRpdXMteGw6IDIwcHg7CiAgICAtLWdyYWRpZW50LXByaW1hcnk6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmYzI2NTEgMCUsICNlOTFlNDcgMTAwJSk7CiAgICAtLWdyYWRpZW50LWFjY2VudDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzhiNWNmNiAwJSwgIzdjM2FlZCAxMDAlKTsKICAgIC0tZ3JhZGllbnQtc3VyZmFjZTogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZmZmZmZiAwJSwgI2Y4ZmFmYyAxMDAlKTsKfQoKLmRhcmstbW9kZSB7CiAgICAtLXByaW1hcnk6ICNmYzI2NTE7CiAgICAtLXByaW1hcnktaG92ZXI6ICNmZjRkNzU7CiAgICAtLXByaW1hcnktbGlnaHQ6IHJnYmEoMjUyLCAzOCwgODEsIDAuMTUpOwogICAgLS1wcmltYXJ5LWxpZ2h0ZXI6IHJnYmEoMjUyLCAzOCwgODEsIDAuMDgpOwogICAgLS1hY2NlbnQ6ICNhODU1Zjc7CiAgICAtLWFjY2VudC1saWdodDogcmdiYSgxNjgsIDg1LCAyNDcsIDAuMTUpOwogICAgLS1zdWNjZXNzOiAjMzRkMzk5OwogICAgLS13YXJuaW5nOiAjZmJiZjI0OwogICAgLS10ZXh0OiAjZjFmNWY5OwogICAgLS10ZXh0LW11dGVkOiAjOTRhM2I4OwogICAgLS10ZXh0LWxpZ2h0OiAjNjQ3NDhiOwogICAgLS1iZzogIzBmMTcyYTsKICAgIC0tYmctc2Vjb25kYXJ5OiAjMWUyOTNiOwogICAgLS1zdXJmYWNlOiAjMWUyOTNiOwogICAgLS1zdXJmYWNlLWhvdmVyOiAjMzM0MTU1OwogICAgLS1ib3JkZXI6ICMzMzQxNTU7CiAgICAtLWJvcmRlci1saWdodDogIzQ3NTU2OTsKICAgIC0tZ2xhc3M6IHJnYmEoMzAsIDQxLCA1OSwgMC44KTsKICAgIC0tc2hhZG93LXhzOiAwIDFweCAycHggMCByZ2IoMCAwIDAgLyAwLjQpOwogICAgLS1zaGFkb3ctc206IDAgMXB4IDNweCAwIHJnYigwIDAgMCAvIDAuNSksIDAgMXB4IDJweCAtMXB4IHJnYigwIDAgMCAvIDAuNSk7CiAgICAtLXNoYWRvdzogMCA0cHggNnB4IC0xcHggcmdiKDAgMCAwIC8gMC41KSwgMCAycHggNHB4IC0ycHggcmdiKDAgMCAwIC8gMC41KTsKICAgIC0tc2hhZG93LWxnOiAwIDEwcHggMTVweCAtM3B4IHJnYigwIDAgMCAvIDAuNiksIDAgNHB4IDZweCAtNHB4IHJnYigwIDAgMCAvIDAuNik7CiAgICAtLXNoYWRvdy14bDogMCAyMHB4IDI1cHggLTVweCByZ2IoMCAwIDAgLyAwLjcpLCAwIDhweCAxMHB4IC02cHggcmdiKDAgMCAwIC8gMC43KTsKICAgIC0tc2hhZG93LWdsb3c6IDAgMCAyMHB4IHJnYmEoMjUyLCAzOCwgODEsIDAuNCk7CiAgICAtLWdyYWRpZW50LXByaW1hcnk6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmYzI2NTEgMCUsICNmZjRkNzUgMTAwJSk7CiAgICAtLWdyYWRpZW50LWFjY2VudDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2E4NTVmNyAwJSwgIzkzMzNlYSAxMDAlKTsKICAgIC0tZ3JhZGllbnQtc3VyZmFjZTogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzFlMjkzYiAwJSwgIzMzNDE1NSAxMDAlKTsKfQoKKiB7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Owp9Cgpib2R5IHsKICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTRiBQcm8gRGlzcGxheScsICdTZWdvZSBVSScsIHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICBtYXJnaW46IDA7CiAgICBwYWRkaW5nOiAwOwogICAgYmFja2dyb3VuZDogdmFyKC0tYmcpOwogICAgY29sb3I6IHZhcigtLXRleHQpOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKICAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7Cn0KCmhlYWRlciB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmFkaWVudC1wcmltYXJ5KTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICB0b3A6IDA7CiAgICB6LWluZGV4OiAxMDA7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctbGcpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwp9CgouaGVhZGVyLWNvbnRlbnQgewogICAgbWF4LXdpZHRoOiAxMjAwcHg7CiAgICBtYXJnaW46IDAgYXV0bzsKICAgIHBhZGRpbmc6IDEuMjVyZW0gMXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgZ2FwOiAxLjVyZW07Cn0KCi5sb2dvIHsKICAgIGZvbnQtc2l6ZTogMS43NXJlbTsKICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICBsZXR0ZXItc3BhY2luZzogLTAuMDJlbTsKICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmZmZmZmYgMCUsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KSAxMDAlKTsKICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0OwogICAgLXdlYmtpdC10ZXh0LWZpbGwtY29sb3I6IHRyYW5zcGFyZW50OwogICAgYmFja2dyb3VuZC1jbGlwOiB0ZXh0Owp9Cgouc2VhcmNoLWNvbnRhaW5lciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleDogMTsKICAgIG1heC13aWR0aDogNTAwcHg7CiAgICBnYXA6IDAuNzVyZW07Cn0KCiNzZWFyY2hCYXIgewogICAgZmxleDogMTsKICAgIHBhZGRpbmc6IDAuODc1cmVtIDFyZW07CiAgICBib3JkZXI6IDA7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwogICAgY29sb3I6IHZhcigtLXRleHQpOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwp9Cgojc2VhcmNoQmFyOmZvY3VzIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLXRleHQpOwogICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoMjUyLCAzOCwgODEsIDAuMjUpLCB2YXIoLS1zaGFkb3cpOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwogICAgY29sb3I6IHZhcigtLWdsYXNzKTsKfQoKI3NlYXJjaEJhcjo6cGxhY2Vob2xkZXIgewogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwp9Cgojc29ydE9wdGlvbnMgewogICAgcGFkZGluZzogMC44NzVyZW0gMXJlbTsKICAgIGJvcmRlcjogMDsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcyk7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMjBweCk7CiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICBmb250LXNpemU6IDE1cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBvdXRsaW5lOiBub25lOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIG1pbi13aWR0aDogMTMwcHg7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwp9Cgojc29ydE9wdGlvbnM6aG92ZXIgewogICAgYmFja2dyb3VuZDogdmFyKC0tdGV4dCk7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgY29sb3I6IHZhcigtLWdsYXNzKTsKfQoKI2ZpbHRlck9wdGlvbnMgewogICAgcGFkZGluZzogMC44NzVyZW0gMXJlbTsKICAgIGJvcmRlcjogMDsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcyk7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMjBweCk7CiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICBmb250LXNpemU6IDE1cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBvdXRsaW5lOiBub25lOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIG1pbi13aWR0aDogMTMwcHg7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwp9CgojZmlsdGVyT3B0aW9uczpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS10ZXh0KTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdyk7CiAgICBjb2xvcjogdmFyKC0tZ2xhc3MpOwp9CgouY29udHJvbC1idXR0b25zIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBnYXA6IDAuNXJlbTsKfQoKbWFpbiB7CiAgICBtYXJnaW46IDAgYXV0bzsKICAgIHBhZGRpbmc6IDJyZW0gMXJlbTsKICAgIHBhZGRpbmctYm90dG9tOiA2cmVtOwp9Cgojem9uZUNvdW50IHsKICAgIG1hcmdpbjogMCAwIDEuNXJlbTsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGdhcDogMC41cmVtOwp9Cgojem9uZUNvdW50OjpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICB3aWR0aDogNHB4OwogICAgaGVpZ2h0OiA0cHg7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5KTsKfQoKI2NvbnRhaW5lciwKI2ZlYXR1cmVkWm9uZXMgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZmlsbCwgbWlubWF4KDIwMHB4LCAxZnIpKTsKICAgIGdhcDogMS41cmVtOwp9Cgouem9uZS1pdGVtIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLWdyYWRpZW50LXN1cmZhY2UpOwogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1sZyk7CiAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgdHJhbnNpdGlvbjogYWxsIDAuNHMgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXNtKTsKfQoKLnpvbmUtaXRlbTpob3ZlciB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLThweCkgc2NhbGUoMS4wMik7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cteGwpOwogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5KTsKfQoKLnpvbmUtaXRlbTpob3Zlcjo6YmVmb3JlIHsKICAgIG9wYWNpdHk6IDE7Cn0KCi56b25lLWl0ZW06OmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGluc2V0OiAwOwogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1saWdodCk7CiAgICBvcGFjaXR5OiAwOwogICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjRzIGVhc2U7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIHotaW5kZXg6IDE7Cn0KCi56b25lLWl0ZW0gaW1nIHsKICAgIHdpZHRoOiAxMDAlOwogICAgYXNwZWN0LXJhdGlvOiAxOwogICAgb2JqZWN0LWZpdDogY292ZXI7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1saWdodCk7CiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC40cyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwp9Cgouem9uZS1pdGVtOmhvdmVyIGltZyB7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOwp9Cgouem9uZS1pdGVtIGJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgIGNvbG9yOiB2YXIoLS10ZXh0KTsKICAgIGJvcmRlcjogMDsKICAgIHBhZGRpbmc6IDEuMjVyZW0gMXJlbTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBmb250LXNpemU6IDE0cHg7CiAgICBsaW5lLWhlaWdodDogMS40OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIG1pbi1oZWlnaHQ6IDcwcHg7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgei1pbmRleDogMjsKfQoKLnpvbmUtaXRlbTpob3ZlciBidXR0b24gewogICAgY29sb3I6IHZhcigtLXByaW1hcnkpOwogICAgYmFja2dyb3VuZDogcmdiYSgyNTIsIDM4LCA4MSwgMC4wNSk7Cn0KCiN6b25lVmlld2VyIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGluc2V0OiAwOwogICAgYmFja2dyb3VuZDogdmFyKC0tYmcpOwogICAgei1pbmRleDogMTAwMDsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgYW5pbWF0aW9uOiBzbGlkZUluVXAgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwp9CgpAa2V5ZnJhbWVzIHNsaWRlSW5VcCB7CiAgICBmcm9tIHsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAwJSk7CiAgICB9CiAgICB0byB7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOwogICAgfQp9Cgouem9uZS1oZWFkZXIgewogICAgYmFja2dyb3VuZDogdmFyKC0tZ3JhZGllbnQtcHJpbWFyeSk7CiAgICBjb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiAwLjRyZW0gMS41cmVtOwogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctbGcpOwp9Cgouem9uZS10aXRsZSB7CiAgICBmbGV4OiAxOwogICAgbWluLXdpZHRoOiAwOwp9Cgojem9uZU5hbWUgewogICAgZm9udC1zaXplOiAxLjI1cmVtOwogICAgZm9udC13ZWlnaHQ6IDcwMDsKICAgIG1hcmdpbjogMCAwIDAuMjVyZW07CiAgICBsaW5lLWhlaWdodDogMS4zOwp9Cgojem9uZUlkIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCiN6b25lQXV0aG9yIHsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCk7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOwogICAgZm9udC13ZWlnaHQ6IDUwMDsKfQoKI3pvbmVBdXRob3I6aG92ZXIgewogICAgY29sb3I6IHdoaXRlOwogICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7Cn0KCi56b25lLWNvbnRyb2xzIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBnYXA6IDAuNzVyZW07Cn0KCi56b25lLWNvbnRyb2xzIGJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7CiAgICBjb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiAwLjYyNXJlbSAxcmVtOwogICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwp9Cgouem9uZS1jb250cm9scyBidXR0b246aG92ZXIgewogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwp9Cgojem9uZUZyYW1lIHsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGJvcmRlcjogbm9uZTsKICAgIHdpZHRoOiA5MCU7CiAgICBoZWlnaHQ6IDkwJTsKfQoKI3BvcHVwT3ZlcmxheSB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICBpbnNldDogMDsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC42KTsKICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig4cHgpOwogICAgZGlzcGxheTogbm9uZTsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIHotaW5kZXg6IDIwMDA7CiAgICBwYWRkaW5nOiAxcmVtOwogICAgYW5pbWF0aW9uOiBmYWRlSW4gMC4zcyBlYXNlOwp9CgpAa2V5ZnJhbWVzIGZhZGVJbiB7CiAgICBmcm9tIHsKICAgICAgICBvcGFjaXR5OiAwOwogICAgfQogICAgdG8gewogICAgICAgIG9wYWNpdHk6IDE7CiAgICB9Cn0KCi5wb3B1cCB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlKTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1sZyk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cteGwpOwogICAgd2lkdGg6IDEwMCU7CiAgICBtYXgtd2lkdGg6IDUyMHB4OwogICAgbWF4LWhlaWdodDogODB2aDsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICBhbmltYXRpb246IHNsaWRlSW5TY2FsZSAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7Cn0KCkBrZXlmcmFtZXMgc2xpZGVJblNjYWxlIHsKICAgIGZyb20gewogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45KSB0cmFuc2xhdGVZKDIwcHgpOwogICAgICAgIG9wYWNpdHk6IDA7CiAgICB9CiAgICB0byB7CiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKSB0cmFuc2xhdGVZKDApOwogICAgICAgIG9wYWNpdHk6IDE7CiAgICB9Cn0KCi5wb3B1cC1oZWFkZXIgewogICAgYmFja2dyb3VuZDogdmFyKC0tZ3JhZGllbnQtcHJpbWFyeSk7CiAgICBjb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiAxLjI1cmVtIDEuNXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgojcG9wdXBUaXRsZSB7CiAgICBtYXJnaW46IDA7CiAgICBmb250LXNpemU6IDEuMjVyZW07CiAgICBmb250LXdlaWdodDogNzAwOwp9CgojcG9wdXBDbG9zZSB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3JkZXI6IDA7CiAgICBjb2xvcjogd2hpdGU7CiAgICBmb250LXNpemU6IDEuMjVyZW07CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBwYWRkaW5nOiAwLjVyZW07CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIGxpbmUtaGVpZ2h0OiAxOwogICAgd2lkdGg6IDM2cHg7CiAgICBoZWlnaHQ6IDM2cHg7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwp9CgojcG9wdXBDbG9zZTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7Cn0KCiNwb3B1cEJvZHkgewogICAgcGFkZGluZzogMS41cmVtOwogICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIGNvbG9yOiB2YXIoLS10ZXh0KTsKfQoKI3BvcHVwQm9keSBpbnB1dFt0eXBlPSJ0ZXh0Il0sCiNwb3B1cEJvZHkgaW5wdXRbdHlwZT0iZmlsZSJdIHsKICAgIHdpZHRoOiAxMDAlOwogICAgcGFkZGluZzogMC44NzVyZW0gMXJlbTsKICAgIG1hcmdpbi1ib3R0b206IDEuMjVyZW07CiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzKTsKICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLXNlY29uZGFyeSk7CiAgICBjb2xvcjogdmFyKC0tdGV4dCk7CiAgICBmb250LXNpemU6IDE1cHg7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwogICAgb3V0bGluZTogbm9uZTsKfQoKI3BvcHVwQm9keSBpbnB1dFt0eXBlPSJ0ZXh0Il06Zm9jdXMsCiNwb3B1cEJvZHkgaW5wdXRbdHlwZT0iZmlsZSJdOmZvY3VzIHsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeSk7CiAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgyNTIsIDM4LCA4MSwgMC4xKTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKfQoKZm9vdGVyIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLXNlY29uZGFyeSk7CiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgIHBhZGRpbmc6IDFyZW0gMXJlbTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKCiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICBib3R0b206IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICB6LWluZGV4OiAxMDA7Cn0KCi5mb290ZXItbGlua3MgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgZ2FwOiAycmVtOwogICAgZmxleC13cmFwOiB3cmFwOwp9CgouZm9vdGVyLWxpbmtzIGEgewogICAgY29sb3I6IHZhcigtLXByaW1hcnkpOwogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIGZvbnQtc2l6ZTogMTVweDsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBwYWRkaW5nOiAwLjVyZW0gMXJlbTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7Cn0KCi5mb290ZXItbGlua3MgYTpob3ZlciB7CiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ob3Zlcik7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWxpZ2h0KTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKfQoKQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7CiAgICAuaGVhZGVyLWNvbnRlbnQgewogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAxcmVtOwogICAgICAgIHBhZGRpbmc6IDFyZW07CiAgICB9CgogICAgLnNlYXJjaC1jb250YWluZXIgewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIG1heC13aWR0aDogbm9uZTsKICAgIH0KCiAgICBtYWluIHsKICAgICAgICBwYWRkaW5nOiAxLjVyZW0gMXJlbTsKICAgIH0KCiAgICAjY29udGFpbmVyLAogICAgI2ZlYXR1cmVkWm9uZXMgewogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZmlsbCwgbWlubWF4KDE2MHB4LCAxZnIpKTsKICAgICAgICBnYXA6IDEuMjVyZW07CiAgICB9CgogICAgLnpvbmUtaXRlbSBidXR0b24gewogICAgICAgIHBhZGRpbmc6IDFyZW0gMC43NXJlbTsKICAgICAgICBtaW4taGVpZ2h0OiA2NXB4OwogICAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgIH0KCiAgICAuZm9vdGVyLWxpbmtzIHsKICAgICAgICBnYXA6IDEuNXJlbTsKICAgIH0KfQoKQG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7CiAgICAjY29udGFpbmVyLAogICAgI2ZlYXR1cmVkWm9uZXMgewogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZmlsbCwgbWlubWF4KDE0MHB4LCAxZnIpKTsKICAgICAgICBnYXA6IDFyZW07CiAgICB9CgogICAgLnBvcHVwIHsKICAgICAgICBtYXJnaW46IDAuNXJlbTsKICAgIH0KCiAgICAuem9uZS1pdGVtOmhvdmVyIHsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpIHNjYWxlKDEuMDEpOwogICAgfQoKfQouY29udHJvbC1idXR0b24gaW1nIHsKICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjRzIGVhc2U7CiAgICB3aWR0aDogMjRweDsKICAgIGhlaWdodDogMjRweDsKfQoKLmNvbnRyb2wtYnV0dG9uOmhvdmVyIGltZyB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSg0MGRlZyk7Cn0KCi5jb250cm9sLWJ1dHRvbiwKLmNvbnRyb2wtYnV0dG9uOmhvdmVyIHsKICAgIGJveC1zaGFkb3c6IG5vbmU7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctbGcpOwp9Ci5jb250cm9sLWJ1dHRvbjphY3RpdmUgewogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOwp9CgouY29udHJvbC1idXR0b25zIGJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3JkZXI6IDA7CiAgICBjb2xvcjogd2hpdGU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBwYWRkaW5nOiAwOwogICAgd2lkdGg6IDQ0cHg7CiAgICBoZWlnaHQ6IDQ0cHg7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigyMHB4KTsKfQouY29udHJvbC1idXR0b25zIGJ1dHRvbjpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7Cn0KLnNldHRpbmdzLWJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmFkaWVudC1wcmltYXJ5KTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGJvcmRlcjogMDsKICAgIHBhZGRpbmc6IDAuODc1cmVtIDEuNXJlbTsKICAgIGZvbnQtc2l6ZTogMTVweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zbSk7CiAgICBtaW4td2lkdGg6IDIwMHB4OwogICAgd2lkdGg6IDEwMCU7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KCi5zZXR0aW5ncy1idXR0b246aG92ZXIgewogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0ycHgpOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LWxnKTsKfQoKLnNldHRpbmdzLWJ1dHRvbjphY3RpdmUgewogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXNtKTsKfQoKLmluZm8tYnV0dG9uIHsKICAgIGJhY2tncm91bmQ6IG5vbmU7CiAgICBib3JkZXI6IG5vbmU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBwYWRkaW5nOiAwOwogICAgbWFyZ2luLWxlZnQ6IDEwcHg7CiAgICBkaXNwbGF5OiBpbmxpbmUtZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIHdpZHRoOiAyNHB4OwogICAgaGVpZ2h0OiAyNHB4OwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzLCB0cmFuc2Zvcm0gMC4yczsKICAgIGNvbG9yOiBpbmhlcml0OwogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKfQoKLmluZm8tYnV0dG9uOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKfQoKLmluZm8tYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOwp9CgouaW5mby1idXR0b24gc3ZnIHsKICAgIGRpc3BsYXk6IGJsb2NrOwp9CiAgICA8L3N0eWxlPgogICAgPGxpbmsgcmVsPSJtYW5pZmVzdCIgaHJlZj0ibWFuaWZlc3QuanNvbiI+CiAgICA8bWV0YSBuYW1lPSJ0aGVtZS1jb2xvciIgY29udGVudD0iI2ZiMjY1MSI+CjwvaGVhZD4KPGJvZHkgY2xhc3M9ImRhcmstbW9kZSI+CgogICAgPGhlYWRlcj4KICAgICAgICA8ZGl2IGNsYXNzPSJoZWFkZXItY29udGVudCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxvZ28iPmduLW1hdGg8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VhcmNoLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InNlYXJjaEJhciIgcGxhY2Vob2xkZXI9IlNlYXJjaCB6b25lcy4uLiIgb25pbnB1dD0iZmlsdGVyWm9uZXMoKSI+CiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJzb3J0T3B0aW9ucyIgb25jaGFuZ2U9InNvcnRab25lcygpIj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJuYW1lIj5OYW1lPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iaWQiPklEIChEYXRlKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InBvcHVsYXIiPlBvcHVsYXI8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ0cmVuZGluZ0RheSI+VHJlbmRpbmcgKERheSk8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ0cmVuZGluZ1dlZWsiPlRyZW5kaW5nIChXZWVrKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InRyZW5kaW5nTW9udGgiPlRyZW5kaW5nIChNb250aCk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iZmlsdGVyT3B0aW9ucyIgb25jaGFuZ2U9ImZpbHRlclpvbmVzMigpIj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJub25lIj4oU0VMRUNUIFRBRyk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1idXR0b25zIj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InJlZnJlc2giIGNsYXNzPSJjb250cm9sLWJ1dHRvbiIgdGl0bGU9IlJlZnJlc2ggYWxsIHRoZSB6b25lcyIgb25jbGljaz0ibGlzdFpvbmVzKCkiPgogICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJyZWZyZXNoLWljb24ucG5nIiBhbHQ9InJlZnJlc2giPgogICAgICAgICAgICAgICAgPC9idXR0b24+CgogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2V0dGluZ3MiIGNsYXNzPSJjb250cm9sLWJ1dHRvbiIgdGl0bGU9IlNldHRpbmdzISI+CiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9InNldHRpbmcucG5nIiBhbHQ9InNldHRpbmdzIj4KICAgICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvaGVhZGVyPgoJPG1haW4+CjxzY3JpcHQ+CihmdW5jdGlvbiAoKSB7CiAgY29uc3QgYmxvY2sgPSAoKSA9PiB7CiAgICBjb25zb2xlLndhcm4oIkJsb2NrZWQgcmVkaXJlY3QgYXR0ZW1wdCIpOwogIH07CgogIHRyeSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAibG9jYXRpb24iLCB7CiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYXNzaWduOiBibG9jaywKICAgICAgICAgIHJlcGxhY2U6IGJsb2NrLAogICAgICAgICAgcmVsb2FkOiBibG9jaywKICAgICAgICAgIGhyZWY6IHdpbmRvdy5sb2NhdGlvbi5ocmVmCiAgICAgICAgfTsKICAgICAgfSwKICAgICAgc2V0OiBibG9jawogICAgfSk7CiAgfSBjYXRjaCAoZSkge30KCiAgd2luZG93Lm9wZW4gPSBmdW5jdGlvbiAoKSB7CiAgICBjb25zb2xlLndhcm4oIkJsb2NrZWQgd2luZG93Lm9wZW4iKTsKICAgIHJldHVybiBudWxsOwogIH07CiAgdHJ5IHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICJ0b3AiLCB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gd2luZG93OwogICAgICB9CiAgICB9KTsKICB9IGNhdGNoIChlKSB7fQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJiZWZvcmV1bmxvYWQiLCAoZSkgPT4gewogICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICB9LCB0cnVlKTsKCn0pKCk7Cjwvc2NyaXB0PgoKPHNjcmlwdD4KICBhdE9wdGlvbnMgPSB7CiAgICAna2V5JyA6ICdmNzVlYWYxYmViZDA4NTQ5NzY2NGFiOTA1OGE2MDE3YycsCiAgICAnZm9ybWF0JyA6ICdpZnJhbWUnLAogICAgJ2hlaWdodCcgOiA5MCwKICAgICd3aWR0aCcgOiA3MjgsCiAgICAncGFyYW1zJyA6IHt9CiAgfTsKPC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJodHRwczovL3d3dy5oaWdocGVyZm9ybWFuY2Vmb3JtYXQuY29tL2Y3NWVhZjFiZWJkMDg1NDk3NjY0YWI5MDU4YTYwMTdjL2ludm9rZS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQ+CiAgYXRPcHRpb25zID0gewogICAgJ2tleScgOiAnZjc1ZWFmMWJlYmQwODU0OTc2NjRhYjkwNThhNjAxN2MnLAogICAgJ2Zvcm1hdCcgOiAnaWZyYW1lJywKICAgICdoZWlnaHQnIDogOTAsCiAgICAnd2lkdGgnIDogNzI4LAogICAgJ3BhcmFtcycgOiB7fQogIH07Cjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly93d3cuaGlnaHBlcmZvcm1hbmNlZm9ybWF0LmNvbS9mNzVlYWYxYmViZDA4NTQ5NzY2NGFiOTA1OGE2MDE3Yy9pbnZva2UuanMiPjwvc2NyaXB0Pgo8L2Rpdj4KICAgIDxicj4KICAgICAgICA8ZGV0YWlscyBpZD0iZmVhdHVyZWRab25lc1dyYXBwZXIiIG9wZW4+CiAgICAgICAgICAgIDxzdW1tYXJ5IGlkPSJhbGxab25lc1N1bW1hcnkiIHN0eWxlPSJmb250LXNpemU6IDEuMnJlbTsgZm9udC13ZWlnaHQ6IGJvbGQ7IGN1cnNvcjogcG9pbnRlcjsiPkZlYXR1cmVkIFpvbmVzPC9zdW1tYXJ5PgogICAgICAgICAgICA8ZGl2IGlkPSJmZWF0dXJlZFpvbmVzIiBjbGFzcz0iem9uZS1jb250YWluZXIiPjwvZGl2PgogICAgICAgIDwvZGV0YWlscz4KICAgICAgICA8YnI+PGhyPjxicj4KICAgICAgICA8ZGV0YWlscyBpZD0iYWxsWm9uZXNXcmFwcGVyIiBvcGVuPgogICAgICAgICAgICA8c3VtbWFyeSBpZD0iYWxsU3VtbWFyeSIgc3R5bGU9ImZvbnQtc2l6ZTogMS4ycmVtOyBmb250LXdlaWdodDogYm9sZDsgY3Vyc29yOiBwb2ludGVyOyI+QWxsIFpvbmVzPC9zdW1tYXJ5PgogICAgICAgICAgICA8ZGl2IGlkPSJjb250YWluZXIiPkxvYWRpbmcuLi48L2Rpdj4KICAgICAgICA8L2RldGFpbHM+CiAgICA8L21haW4+CgogICAgIDxkaXYgaWQ9InpvbmVWaWV3ZXIiPgogICAgICAgIDxkaXYgY2xhc3M9InpvbmUtaGVhZGVyIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iem9uZS10aXRsZSI+CiAgICAgICAgICAgICAgICA8aDIgaWQ9InpvbmVOYW1lIj56b25lPC9oMj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImluZm8tYnV0dG9uIiBvbmNsaWNrPSJzaG93Wm9uZUluZm8oKSIgdGl0bGU9IlpvbmUgSW5mb3JtYXRpb24iPgogICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiPjwvY2lyY2xlPgogICAgICAgICAgICAgICAgICAgICAgICA8bGluZSB4MT0iMTIiIHkxPSIxNiIgeDI9IjEyIiB5Mj0iMTIiPjwvbGluZT4KICAgICAgICAgICAgICAgICAgICAgICAgPGxpbmUgeDE9IjEyIiB5MT0iOCIgeDI9IjEyLjAxIiB5Mj0iOCI+PC9saW5lPgogICAgICAgICAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8c3BhbiBpZD0iem9uZUlkIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPjwvc3Bhbj4KICAgICAgICAgICAgICAgIDxhIGlkPSJ6b25lQXV0aG9yIiBocmVmPSIjIiB0YXJnZXQ9Il9ibGFuayI+YnkgQXV0aG9yPC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iem9uZS1jb250cm9scyI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImZ1bGxzY3JlZW5ab25lKCkiPkZ1bGxzY3JlZW48L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iYWJvdXRCbGFuaygpIj5PcGVuIGluIE5ldyBUYWI8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRab25lKCkiPkRvd25sb2FkPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImNsb3NlWm9uZSgpIj5DbG9zZTwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8aWZyYW1lIGlkPSJ6b25lRnJhbWUiPjwvaWZyYW1lPgogICAgPC9kaXY+CgogICAgPGRpdiBpZD0icG9wdXBPdmVybGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJwb3B1cCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InBvcHVwLWhlYWRlciI+CiAgICAgICAgICAgICAgICA8aDMgaWQ9InBvcHVwVGl0bGUiPlRpdGxlPC9oMz4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InBvcHVwQ2xvc2UiIG9uY2xpY2s9ImNsb3NlUG9wdXAoKSI+w5c8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9InBvcHVwQm9keSI+CiAgICAgICAgICAgICAgICBDb250ZW50IHdpbGwgYmUgaGVyZQogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImZvb3Rlci1saW5rcyI+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9ImxvYWRETUNBKCk7IHJldHVybiBmYWxzZTsiPkRNQ0E8L2E+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9InNob3dDb250YWN0KCk7IHJldHVybiBmYWxzZTsiPkNvbnRhY3Q8L2E+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9ImxvYWRQcml2YWN5KCk7IHJldHVybiBmYWxzZTsiPlByaXZhY3kgUG9saWN5PC9hPgogICAgICAgICAgICA8YSBocmVmPSJqYXZhc2NyaXB0OnNhdmVEYXRhKCkiPkV4cG9ydCBEYXRhPC9hPgogICAgICAgICAgICA8YSBocmVmPSIjIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1wb3J0RGF0YScpLmNsaWNrKCk7IHJldHVybiBmYWxzZTsiPkltcG9ydCBEYXRhPC9hPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgaWQ9ImltcG9ydERhdGEiIHN0eWxlPSJkaXNwbGF5OiBub25lOyIgb25jaGFuZ2U9ImxvYWREYXRhKGV2ZW50KSI+CiAgICAgICAgPC9kaXY+CiAgICA8L2Zvb3Rlcj4KCiAgICA8c2NyaXB0Pgpjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7CmNvbnN0IHpvbmVWaWV3ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZVZpZXdlcicpOwpsZXQgem9uZUZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVGcmFtZScpOwpjb25zdCBzZWFyY2hCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoQmFyJyk7CmNvbnN0IHNvcnRPcHRpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvcnRPcHRpb25zJyk7CmNvbnN0IGZpbHRlck9wdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3B0aW9ucycpOwovLyBodHRwczovL3d3dy5qc2RlbGl2ci5jb20vdG9vbHMvcHVyZ2UKY29uc3Qgem9uZXN1cmxzID0gWwogICAgImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC8lNjclNjgvJTY3JTZlJTJkJTZkJTYxJTc0JTY4LyU2MSU3MyU3MyU2NSU3NCU3M0AlNmQlNjElNjklNmUvJTdhJTZmJTZlJTY1JTczJTJlJTZhJTczJTZmJTZlIiwKICAgICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9hc3NldHNAbGF0ZXN0L3pvbmVzLmpzb24iLAogICAgImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2Fzc2V0c0BtYXN0ZXIvem9uZXMuanNvbiIsCiAgICAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2duLW1hdGgvYXNzZXRzL3pvbmVzLmpzb24iCl07CmxldCB6b25lc1VSTCA9IHpvbmVzdXJsc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB6b25lc3VybHMubGVuZ3RoKV07CmNvbnN0IGNvdmVyVVJMID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2NvdmVyc0BtYWluIjsKY29uc3QgaHRtbFVSTCA9ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9odG1sQG1haW4iOwpsZXQgem9uZXMgPSBbXTsKbGV0IHBvcHVsYXJpdHlEYXRhID0ge307CmNvbnN0IGZlYXR1cmVkQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZlYXR1cmVkWm9uZXMnKTsKZnVuY3Rpb24gdG9UaXRsZUNhc2Uoc3RyKSB7CiAgcmV0dXJuIHN0ci5yZXBsYWNlKAogICAgL1x3XFMqL2csCiAgICB0ZXh0ID0+IHRleHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0ZXh0LnN1YnN0cmluZygxKS50b0xvd2VyQ2FzZSgpCiAgKTsKfQphc3luYyBmdW5jdGlvbiBsaXN0Wm9uZXMoKSB7CiAgICB0cnkgewogICAgICBsZXQgc2hhcmVzcG9uc2U7CiAgICAgIGxldCBzaGFqc29uOwogICAgICBsZXQgc2hhOwogICAgICAgIHRyeSB7CiAgICAgICAgICBzaGFyZXNwb25zZSA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL2duLW1hdGgvYXNzZXRzL2NvbW1pdHM/dD0iK0RhdGUubm93KCkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fQogICAgICAgIGlmIChzaGFyZXNwb25zZSAmJiBzaGFyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2hhanNvbiA9IGF3YWl0IHNoYXJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgc2hhID0gc2hhanNvblswXVsnc2hhJ107CiAgICAgICAgICAgIGlmIChzaGEpIHsKICAgICAgICAgICAgICAgIHpvbmVzVVJMID0gYGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2Fzc2V0c0Ake3NoYX0vem9uZXMuanNvbmA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgc2Vjb25kYXJ5c2hhcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2duLW1hdGgveG1sL3JlZnMvaGVhZHMvbWFpbi9zaGEudHh0P3Q9IitEYXRlLm5vdygpKTsKICAgICAgICAgICAgICAgIGlmIChzZWNvbmRhcnlzaGFyZXNwb25zZSAmJiBzZWNvbmRhcnlzaGFyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHNoYSA9IChhd2FpdCBzZWNvbmRhcnlzaGFyZXNwb25zZS50ZXh0KCkpLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc2hhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHpvbmVzVVJMID0gYGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2Fzc2V0c0Ake3NoYX0vem9uZXMuanNvbmA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7fQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHpvbmVzVVJMKyI/dD0iK0RhdGUubm93KCkpOwogICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgem9uZXMgPSBqc29uOwogICAgICAgIHpvbmVzWzBdLmZlYXR1cmVkID0gdHJ1ZTsgLy8gYWx3YXlzIGdvbm5hIGJlIHRoZSBkaXNjb3JkCiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW2ZldGNoUG9wdWxhcml0eSgieWVhciIpLCBmZXRjaFBvcHVsYXJpdHkoIm1vbnRoIiksIGZldGNoUG9wdWxhcml0eSgid2VlayIpLCBmZXRjaFBvcHVsYXJpdHkoImRheSIpXSk7CiAgICAgICAgc29ydFpvbmVzKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBzZWFyY2ggPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpOwogICAgICAgIGNvbnN0IGlkID0gc2VhcmNoLmdldCgnaWQnKTsKICAgICAgICBjb25zdCBlbWJlZCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLmluY2x1ZGVzKCJlbWJlZCIpOwogICAgICAgIGlmIChpZCkgewogICAgICAgICAgICBjb25zdCB6b25lID0gem9uZXMuZmluZCh6b25lID0+IHpvbmUuaWQgKyAnJyA9PSBpZCArICcnKTsKICAgICAgICAgICAgaWYgKHpvbmUpIHsKICAgICAgICAgICAgICAgIGlmIChlbWJlZCkgewogICAgICAgICAgICAgICAgICAgIGlmICh6b25lLnVybC5zdGFydHNXaXRoKCJodHRwIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oem9uZS51cmwsICJfYmxhbmsiKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSB6b25lLnVybC5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZldGNoKHVybCsiP3Q9IitEYXRlLm5vdygpKS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLnRleHQoKSkudGhlbihodG1sID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUwgPSBodG1sOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLnN0eWxlLnBvc2l0aW9uID0gImZpeGVkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLnN0eWxlLmJvdHRvbSA9ICIyMHB4IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLnN0eWxlLnJpZ2h0ID0gIjIwcHgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gIiNjY2U1ZmYiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuY29sb3IgPSAiIzAwNDA4NSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5wYWRkaW5nID0gIjEwcHgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuYm9yZGVyID0gIjFweCBzb2xpZCAjYjhkYWZmIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLnN0eWxlLmJvcmRlclJhZGl1cyA9ICI1cHgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuYm94U2hhZG93ID0gIjBweCAwcHggMTBweCByZ2JhKDAsMCwwLDAuMSkiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuZm9udEZhbWlseSA9ICJBcmlhbCwgc2Fucy1zZXJpZiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLmlubmVySFRNTCA9IGBQbGF5IG1vcmUgZ2FtZXMgYXQgPGEgaHJlZj0iaHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pbyIgdGFyZ2V0PSJfYmxhbmsiIHN0eWxlPSJjb2xvcjojMDA0MDg1OyBmb250LXdlaWdodDpib2xkOyI+aHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pbzwvYT4hYDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLmlubmVyVGV4dCA9ICI/IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSAiMTBweCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gIm5vbmUiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4uc3R5bGUuYm9yZGVyID0gIm5vbmUiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4uc3R5bGUuY3Vyc29yID0gInBvaW50ZXIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4uc3R5bGUuY29sb3IgPSAiIzAwNDA4NSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5mb250V2VpZ2h0ID0gImJvbGQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4gcG9wdXAucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBvcHVwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHQnKS5mb3JFYWNoKG9sZFNjcmlwdCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFNjcmlwdC5zcmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0LnNyYyA9IG9sZFNjcmlwdC5zcmM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0LnRleHRDb250ZW50ID0gb2xkU2NyaXB0LnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5ld1NjcmlwdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gYWxlcnQoIkZhaWxlZCB0byBsb2FkIHpvbmU6ICIgKyBlcnJvcikpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgb3BlblpvbmUoem9uZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgfSBjYXRjaChlcnJvcil7fQogICAgICAgIGxldCBhbGx0YWdzID0gW107CiAgICAgICAgZm9yIChjb25zdCBvYmogb2YganNvbikgewogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmouc3BlY2lhbCkpIHsKICAgICAgICAgICAgICAgIGFsbHRhZ3MucHVzaCguLi5vYmouc3BlY2lhbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGFsbHRhZ3MgPSBbLi4ubmV3IFNldChhbGx0YWdzKV07CiAgICAgICAgbGV0IGZpbHRlcm9wdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXJPcHRpb25zIik7CiAgICAgICAgaWYgKGZpbHRlcm9wdGlvbiAmJiBmaWx0ZXJvcHRpb24uY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAgICAgICB3aGlsZSAoZmlsdGVyb3B0aW9uLmNoaWxkcmVuLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgIGZpbHRlcm9wdGlvbi5yZW1vdmVDaGlsZChmaWx0ZXJvcHRpb24ubGFzdEVsZW1lbnRDaGlsZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yIChjb25zdCB0YWcgb2YgYWxsdGFncykgewogICAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsKICAgICAgICAgICAgb3B0LnZhbHVlID0gdGFnOwogICAgICAgICAgICBvcHQudGV4dENvbnRlbnQgPSB0b1RpdGxlQ2FzZSh0YWcpOwogICAgICAgICAgICBmaWx0ZXJvcHRpb24uYXBwZW5kQ2hpbGQob3B0KTsKICAgICAgICB9CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgRXJyb3IgbG9hZGluZyB6b25lczogJHtlcnJvcn1gOwogICAgfQp9CmFzeW5jIGZ1bmN0aW9uIGZldGNoUG9wdWxhcml0eShkdXJhdGlvbikgewogICAgdHJ5IHsKICAgICAgICBpZiAoIXBvcHVsYXJpdHlEYXRhW2R1cmF0aW9uXSkgewogICAgICAgICAgICBwb3B1bGFyaXR5RGF0YVtkdXJhdGlvbl0gPSB7fTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgKICAgICAgICAgICAgImh0dHBzOi8vZGF0YS5qc2RlbGl2ci5jb20vdjEvc3RhdHMvcGFja2FnZXMvZ2gvZ24tbWF0aC9odG1sQG1haW4vZmlsZXM/cGVyaW9kPSIgKyBkdXJhdGlvbgogICAgICAgICk7CiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICBkYXRhLmZvckVhY2goZmlsZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGlkTWF0Y2ggPSBmaWxlLm5hbWUubWF0Y2goL1wvKFxkKylcLmh0bWwkLyk7CiAgICAgICAgICAgIGlmIChpZE1hdGNoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBpZCA9IHBhcnNlSW50KGlkTWF0Y2hbMV0pOwogICAgICAgICAgICAgICAgcG9wdWxhcml0eURhdGFbZHVyYXRpb25dW2lkXSA9IGZpbGUuaGl0cz8udG90YWwgPz8gMDsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBpZiAoIXBvcHVsYXJpdHlEYXRhW2R1cmF0aW9uXSkgewogICAgICAgICAgICBwb3B1bGFyaXR5RGF0YVtkdXJhdGlvbl0gPSB7fTsKICAgICAgICB9CiAgICAgICAgcG9wdWxhcml0eURhdGFbZHVyYXRpb25dWzBdID0gMDsKICAgIH0KfQoKCmZ1bmN0aW9uIHNvcnRab25lcygpIHsKICAgIGNvbnN0IHNvcnRCeSA9IHNvcnRPcHRpb25zLnZhbHVlOwogICAgaWYgKHNvcnRCeSA9PT0gJ25hbWUnKSB7CiAgICAgICAgem9uZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7CiAgICB9IGVsc2UgaWYgKHNvcnRCeSA9PT0gJ2lkJykgewogICAgICAgIHpvbmVzLnNvcnQoKGEsIGIpID0+IGEuaWQgLSBiLmlkKTsKICAgIH0gZWxzZSBpZiAoc29ydEJ5ID09PSAncG9wdWxhcicpIHsKICAgICAgICB6b25lcy5zb3J0KChhLCBiKSA9PiAoKHBvcHVsYXJpdHlEYXRhWyd5ZWFyJ10/LltiLmlkXSkgPz8gMCkgLSAoKHBvcHVsYXJpdHlEYXRhWyd5ZWFyJ10/LlthLmlkXSkgPz8gMCkpOwogICAgfSBlbHNlIGlmIChzb3J0QnkgPT09ICd0cmVuZGluZ01vbnRoJykgewogICAgICAgIHpvbmVzLnNvcnQoKGEsIGIpID0+ICgocG9wdWxhcml0eURhdGFbJ21vbnRoJ10/LltiLmlkXSkgPz8gMCkgLSAoKHBvcHVsYXJpdHlEYXRhWydtb250aCddPy5bYS5pZF0pID8/IDApKTsKICAgIH0gZWxzZSBpZiAoc29ydEJ5ID09PSAndHJlbmRpbmdXZWVrJykgewogICAgICAgIHpvbmVzLnNvcnQoKGEsIGIpID0+ICgocG9wdWxhcml0eURhdGFbJ3dlZWsnXT8uW2IuaWRdKSA/PyAwKSAtICgocG9wdWxhcml0eURhdGFbJ3dlZWsnXT8uW2EuaWRdKSA/PyAwKSk7CiAgICB9IGVsc2UgaWYgKHNvcnRCeSA9PT0gJ3RyZW5kaW5nRGF5JykgewogICAgICAgIHpvbmVzLnNvcnQoKGEsIGIpID0+ICgocG9wdWxhcml0eURhdGFbJ2RheSddPy5bYi5pZF0pID8/IDApIC0gKChwb3B1bGFyaXR5RGF0YVsnZGF5J10/LlthLmlkXSkgPz8gMCkpOwogICAgfQogICAgem9uZXMuc29ydCgoYSwgYikgPT4gKGEuaWQgPT09IC0xID8gLTEgOiBiLmlkID09PSAtMSA/IDEgOiAwKSk7CiAgICBpZiAoZmVhdHVyZWRDb250YWluZXIuaW5uZXJIVE1MID09PSAiIikgewogICAgICAgIGNvbnN0IGZlYXR1cmVkID0gem9uZXMuZmlsdGVyKHogPT4gei5mZWF0dXJlZCk7CiAgICAgICAgZGlzcGxheUZlYXR1cmVkWm9uZXMoZmVhdHVyZWQpOwogICAgfQogICAgZGlzcGxheVpvbmVzKHpvbmVzKTsKfQoKZnVuY3Rpb24gZGlzcGxheUZlYXR1cmVkWm9uZXMoZmVhdHVyZWRab25lcykgewogICAgZmVhdHVyZWRDb250YWluZXIuaW5uZXJIVE1MID0gIiI7CiAgICBmZWF0dXJlZFpvbmVzLmZvckVhY2goKGZpbGUsIGluZGV4KSA9PiB7CiAgICAgICAgY29uc3Qgem9uZUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICB6b25lSXRlbS5jbGFzc05hbWUgPSAiem9uZS1pdGVtIjsKICAgICAgICB6b25lSXRlbS5vbmNsaWNrID0gKCkgPT4gb3BlblpvbmUoZmlsZSk7CiAgICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICAgICAgaW1nLmRhdGFzZXQuc3JjID0gZmlsZS5jb3Zlci5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgaW1nLmFsdCA9IGZpbGUubmFtZTsKICAgICAgICBpbWcubG9hZGluZyA9ICJsYXp5IjsKICAgICAgICBpbWcuY2xhc3NOYW1lID0gImxhenktem9uZS1pbWciOwogICAgICAgIHpvbmVJdGVtLmFwcGVuZENoaWxkKGltZyk7CiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gZmlsZS5uYW1lOwogICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICBvcGVuWm9uZShmaWxlKTsKICAgICAgICB9OwogICAgICAgIHpvbmVJdGVtLmFwcGVuZENoaWxkKGJ1dHRvbik7CiAgICAgICAgZmVhdHVyZWRDb250YWluZXIuYXBwZW5kQ2hpbGQoem9uZUl0ZW0pOwogICAgfSk7CiAgICBpZiAoZmVhdHVyZWRDb250YWluZXIuaW5uZXJIVE1MID09PSAiIikgewogICAgICAgIGZlYXR1cmVkQ29udGFpbmVyLmlubmVySFRNTCA9ICJObyBmZWF0dXJlZCB6b25lcyBmb3VuZC4iOwogICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWxsWm9uZXNTdW1tYXJ5IikudGV4dENvbnRlbnQgPSBgRmVhdHVyZWQgWm9uZXMgKCR7ZmVhdHVyZWRab25lcy5sZW5ndGh9KWA7CiAgICB9CgogICAgY29uc3QgbGF6eUltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNmZWF0dXJlZFpvbmVzIGltZy5sYXp5LXpvbmUtaW1nJyk7CiAgICBjb25zdCBpbWFnZU9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnNlcnZlcikgPT4gewogICAgICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7CiAgICAgICAgICAgIGlmIChlbnRyeS5pc0ludGVyc2VjdGluZyAmJiAhem9uZVZpZXdlci5oaWRkZW4pIHsKICAgICAgICAgICAgICAgIGNvbnN0IGltZyA9IGVudHJ5LnRhcmdldDsKICAgICAgICAgICAgICAgIGltZy5zcmMgPSBpbWcuZGF0YXNldC5zcmM7CiAgICAgICAgICAgICAgICBpbWcuY2xhc3NMaXN0LnJlbW92ZSgibGF6eS16b25lLWltZyIpOwogICAgICAgICAgICAgICAgb2JzZXJ2ZXIudW5vYnNlcnZlKGltZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sIHsKICAgICAgICByb290TWFyZ2luOiAiMTAwcHgiLCAKICAgICAgICB0aHJlc2hvbGQ6IDAuMQogICAgfSk7CgogICAgbGF6eUltYWdlcy5mb3JFYWNoKGltZyA9PiB7CiAgICAgICAgaW1hZ2VPYnNlcnZlci5vYnNlcnZlKGltZyk7CiAgICB9KTsKfQpmdW5jdGlvbiBkaXNwbGF5Wm9uZXMoem9uZXMpIHsKICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAiIjsKICAgIHpvbmVzLmZvckVhY2goKGZpbGUsIGluZGV4KSA9PiB7CiAgICAgICAgY29uc3Qgem9uZUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICB6b25lSXRlbS5jbGFzc05hbWUgPSAiem9uZS1pdGVtIjsKICAgICAgICB6b25lSXRlbS5vbmNsaWNrID0gKCkgPT4gb3BlblpvbmUoZmlsZSk7CiAgICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICAgICAgaW1nLmRhdGFzZXQuc3JjID0gZmlsZS5jb3Zlci5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgaW1nLmFsdCA9IGZpbGUubmFtZTsKICAgICAgICBpbWcubG9hZGluZyA9ICJsYXp5IjsKICAgICAgICBpbWcuY2xhc3NOYW1lID0gImxhenktem9uZS1pbWciOwogICAgICAgIHpvbmVJdGVtLmFwcGVuZENoaWxkKGltZyk7CiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gZmlsZS5uYW1lOwogICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICBvcGVuWm9uZShmaWxlKTsKICAgICAgICB9OwogICAgICAgIHpvbmVJdGVtLmFwcGVuZENoaWxkKGJ1dHRvbik7CiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHpvbmVJdGVtKTsgICAKICAgIH0pOwogICAgaWYgKGNvbnRhaW5lci5pbm5lckhUTUwgPT09ICIiKSB7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICJObyB6b25lcyBmb3VuZC4iOwogICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWxsU3VtbWFyeSIpLnRleHRDb250ZW50ID0gYEFsbCBab25lcyAoJHt6b25lcy5sZW5ndGh9KWA7CiAgICB9CgogICAgY29uc3QgbGF6eUltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZy5sYXp5LXpvbmUtaW1nJyk7CiAgICBjb25zdCBpbWFnZU9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnNlcnZlcikgPT4gewogICAgICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7CiAgICAgICAgICAgIGlmIChlbnRyeS5pc0ludGVyc2VjdGluZyAmJiAhem9uZVZpZXdlci5oaWRkZW4pIHsKICAgICAgICAgICAgICAgIGNvbnN0IGltZyA9IGVudHJ5LnRhcmdldDsKICAgICAgICAgICAgICAgIGltZy5zcmMgPSBpbWcuZGF0YXNldC5zcmM7CiAgICAgICAgICAgICAgICBpbWcuY2xhc3NMaXN0LnJlbW92ZSgibGF6eS16b25lLWltZyIpOwogICAgICAgICAgICAgICAgb2JzZXJ2ZXIudW5vYnNlcnZlKGltZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sIHsKICAgICAgICByb290TWFyZ2luOiAiMTAwcHgiLCAKICAgICAgICB0aHJlc2hvbGQ6IDAuMQogICAgfSk7CgogICAgbGF6eUltYWdlcy5mb3JFYWNoKGltZyA9PiB7CiAgICAgICAgaW1hZ2VPYnNlcnZlci5vYnNlcnZlKGltZyk7CiAgICB9KTsKfQoKZnVuY3Rpb24gZmlsdGVyWm9uZXMyKCkgewogICAgY29uc3QgcXVlcnkgPSBmaWx0ZXJPcHRpb25zLnZhbHVlOwogICAgaWYgKHF1ZXJ5ID09PSAibm9uZSIpIHsKICAgICAgICBkaXNwbGF5Wm9uZXMoem9uZXMpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBmaWx0ZXJlZFpvbmVzID0gem9uZXMuZmlsdGVyKHpvbmUgPT4gem9uZS5zcGVjaWFsPy5pbmNsdWRlcyhxdWVyeSkpOwogICAgICAgIGlmIChxdWVyeS5sZW5ndGggIT09IDApIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlYXR1cmVkWm9uZXNXcmFwcGVyIikucmVtb3ZlQXR0cmlidXRlKCJvcGVuIik7CiAgICAgICAgfQogICAgICAgIGRpc3BsYXlab25lcyhmaWx0ZXJlZFpvbmVzKTsKICAgIH0KfQoKZnVuY3Rpb24gZmlsdGVyWm9uZXMoKSB7CiAgICBjb25zdCBxdWVyeSA9IHNlYXJjaEJhci52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZmlsdGVyZWRab25lcyA9IHpvbmVzLmZpbHRlcih6b25lID0+IHpvbmUubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSk7CiAgICBpZiAocXVlcnkubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlYXR1cmVkWm9uZXNXcmFwcGVyIikucmVtb3ZlQXR0cmlidXRlKCJvcGVuIik7CiAgICB9CiAgICBkaXNwbGF5Wm9uZXMoZmlsdGVyZWRab25lcyk7Cn0KCmZ1bmN0aW9uIG9wZW5ab25lKGZpbGUpIHsKICAgIGlmIChmaWxlLnVybC5zdGFydHNXaXRoKCJodHRwIikpIHsKICAgICAgICB3aW5kb3cub3BlbihmaWxlLnVybCwgIl9ibGFuayIpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB1cmwgPSBmaWxlLnVybC5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgZmV0Y2godXJsKyI/dD0iK0RhdGUubm93KCkpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKS50aGVuKGh0bWwgPT4gewogICAgICAgICAgICBpZiAoem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudCA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgem9uZUZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CiAgICAgICAgICAgICAgICB6b25lRnJhbWUuaWQgPSAiem9uZUZyYW1lIjsKICAgICAgICAgICAgICAgIHpvbmVWaWV3ZXIuYXBwZW5kQ2hpbGQoem9uZUZyYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB6b25lRnJhbWUuY29udGVudERvY3VtZW50Lm9wZW4oKTsKICAgICAgICAgICAgem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudC53cml0ZShodG1sKTsKICAgICAgICAgICAgem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZU5hbWUnKS50ZXh0Q29udGVudCA9IGZpbGUubmFtZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVJZCcpLnRleHRDb250ZW50ID0gZmlsZS5pZDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVBdXRob3InKS50ZXh0Q29udGVudCA9ICJieSAiICsgZmlsZS5hdXRob3I7CiAgICAgICAgICAgIGlmIChmaWxlLmF1dGhvckxpbmspIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lQXV0aG9yJykuaHJlZiA9IGZpbGUuYXV0aG9yTGluazsKICAgICAgICAgICAgfQogICAgICAgICAgICB6b25lVmlld2VyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24pOwogICAgICAgICAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2lkJywgZmlsZS5pZCk7CiAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCAnJywgdXJsLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB9IGNhdGNoKGVycm9yKXt9CiAgICAgICAgICAgIHpvbmVWaWV3ZXIuaGlkZGVuID0gdHJ1ZTsKICAgICAgICB9KS5jYXRjaChlcnJvciA9PiBhbGVydCgiRmFpbGVkIHRvIGxvYWQgem9uZTogIiArIGVycm9yKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFib3V0QmxhbmsoKSB7CiAgICBjb25zdCBuZXdXaW5kb3cgPSB3aW5kb3cub3BlbigiYWJvdXQ6YmxhbmsiLCAiX2JsYW5rIik7CiAgICBsZXQgem9uZSA9IHpvbmVzLmZpbmQoem9uZSA9PiB6b25lLmlkICsgJycgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lSWQnKS50ZXh0Q29udGVudCkudXJsLnJlcGxhY2UoIntDT1ZFUl9VUkx9IiwgY292ZXJVUkwpLnJlcGxhY2UoIntIVE1MX1VSTH0iLCBodG1sVVJMKTsKICAgIGZldGNoKHpvbmUrIj90PSIrRGF0ZS5ub3coKSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpLnRoZW4oaHRtbCA9PiB7CiAgICAgICAgaWYgKG5ld1dpbmRvdykgewogICAgICAgICAgICBuZXdXaW5kb3cuZG9jdW1lbnQub3BlbigpOwogICAgICAgICAgICBuZXdXaW5kb3cuZG9jdW1lbnQud3JpdGUoaHRtbCk7CiAgICAgICAgICAgIG5ld1dpbmRvdy5kb2N1bWVudC5jbG9zZSgpOwogICAgICAgIH0KICAgIH0pCn0KCmZ1bmN0aW9uIGNsb3NlWm9uZSgpIHsKICAgIHpvbmVWaWV3ZXIuaGlkZGVuID0gZmFsc2U7CiAgICB6b25lVmlld2VyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICB6b25lVmlld2VyLnJlbW92ZUNoaWxkKHpvbmVGcmFtZSk7CiAgICB0cnkgewogICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24pOwogICAgdXJsLnNlYXJjaFBhcmFtcy5kZWxldGUoJ2lkJyk7CiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCAnJywgdXJsLnRvU3RyaW5nKCkpOwogICAgfSBjYXRjaChlcnJvcil7fQp9CgpmdW5jdGlvbiBkb3dubG9hZFpvbmUoKSB7CiAgICBsZXQgem9uZSA9IHpvbmVzLmZpbmQoem9uZSA9PiB6b25lLmlkICsgJycgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lSWQnKS50ZXh0Q29udGVudCk7CiAgICBmZXRjaCh6b25lLnVybC5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCkrIj90PSIrRGF0ZS5ub3coKSkudGhlbihyZXMgPT4gcmVzLnRleHQoKSkudGhlbih0ZXh0ID0+IHsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3RleHRdLCB7CiAgICAgICAgICAgIHR5cGU6ICJ0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgiCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGEuaHJlZiA9IHVybDsKICAgICAgICBhLmRvd25sb2FkID0gem9uZS5uYW1lICsgIi5odG1sIjsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgIGEuY2xpY2soKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpOwogICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgIH0pOwp9CgpmdW5jdGlvbiBmdWxsc2NyZWVuWm9uZSgpIHsKICAgIGlmICh6b25lRnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4pIHsKICAgICAgICB6b25lRnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgIH0gZWxzZSBpZiAoem9uZUZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuKSB7CiAgICAgICAgem9uZUZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuKCk7CiAgICB9IGVsc2UgaWYgKHpvbmVGcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikgewogICAgICAgIHpvbmVGcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbigpOwogICAgfSBlbHNlIGlmICh6b25lRnJhbWUubXNSZXF1ZXN0RnVsbHNjcmVlbikgewogICAgICAgIHpvbmVGcmFtZS5tc1JlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHNhbml0aXplRGF0YShvYmosIG1heFN0cmluZ0xlbiA9IDEwMDAsIG1heEFycmF5TGVuID0gMTAwMDApIHsKICAgIGlmICh0eXBlb2Ygb2JqID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gb2JqLmxlbmd0aCA+IG1heFN0cmluZ0xlbiA/IG9iai5zbGljZSgwLCBtYXhTdHJpbmdMZW4pICsgJy4uLlt0cnVuY2F0ZWRdJyA6IG9iajsKICAgIH0KICAgIAogICAgaWYgKG9iaiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgaWYgKG9iai5sZW5ndGggPiBtYXhBcnJheUxlbikgewogICAgICAgIHJldHVybiBgW1VpbnQ4QXJyYXkgdG9vIGxhcmdlICgke29iai5sZW5ndGh9IGJ5dGVzKSwgdHJ1bmNhdGVkXWA7CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH0KICAgIAogICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgewogICAgICByZXR1cm4gb2JqLm1hcChpdGVtID0+IHNhbml0aXplRGF0YShpdGVtLCBtYXhTdHJpbmdMZW4sIG1heEFycmF5TGVuKSk7CiAgICB9CiAgICAKICAgIGlmIChvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKICAgICAgY29uc3QgbmV3T2JqID0ge307CiAgICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikgewogICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgbmV3T2JqW2tleV0gPSBzYW5pdGl6ZURhdGEob2JqW2tleV0sIG1heFN0cmluZ0xlbiwgbWF4QXJyYXlMZW4pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3T2JqOwogICAgfQogICAgCiAgICByZXR1cm4gb2JqOwogIH0KCmFzeW5jIGZ1bmN0aW9uIHNhdmVEYXRhKCkgewogICAgYWxlcnQoIlRoaXMgbWlnaHQgdGFrZSBhIHdoaWxlLCBkb250IHRvdWNoIGFueXRoaW5nIG90aGVyIHRoYW4gdGhpcyBPSyBidXR0b24iKTsKICAgIGNvbnN0IHJlc3VsdCA9IHt9OwogICAgcmVzdWx0LmNvb2tpZXMgPSBkb2N1bWVudC5jb29raWU7CiAgICByZXN1bHQubG9jYWxTdG9yYWdlID0gey4uLmxvY2FsU3RvcmFnZX07CiAgICByZXN1bHQuc2Vzc2lvblN0b3JhZ2UgPSB7Li4uc2Vzc2lvblN0b3JhZ2V9OwogICAgcmVzdWx0LmluZGV4ZWREQiA9IHt9OwogICAgY29uc3QgZGJzID0gYXdhaXQgaW5kZXhlZERCLmRhdGFiYXNlcygpOwogICAgZm9yIChjb25zdCBkYkluZm8gb2YgZGJzKSB7CiAgICAgIGlmICghZGJJbmZvLm5hbWUpIGNvbnRpbnVlOwogICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXSA9IHt9OwogICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgY29uc3Qgb3BlblJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYkluZm8ubmFtZSwgZGJJbmZvLnZlcnNpb24pOwogICAgICAgIG9wZW5SZXF1ZXN0Lm9uZXJyb3IgPSAoKSA9PiByZWplY3Qob3BlblJlcXVlc3QuZXJyb3IpOwogICAgICAgIG9wZW5SZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHsKICAgICAgICAgIGNvbnN0IGRiID0gb3BlblJlcXVlc3QucmVzdWx0OwogICAgICAgICAgY29uc3Qgc3RvcmVOYW1lcyA9IEFycmF5LmZyb20oZGIub2JqZWN0U3RvcmVOYW1lcyk7CiAgICAgICAgICBpZiAoc3RvcmVOYW1lcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZXMsICJyZWFkb25seSIpOwogICAgICAgICAgY29uc3Qgc3RvcmVQcm9taXNlcyA9IFtdOwogICAgICAgICAgZm9yIChjb25zdCBzdG9yZU5hbWUgb2Ygc3RvcmVOYW1lcykgewogICAgICAgICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXVtzdG9yZU5hbWVdID0gW107CiAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTsKICAgICAgICAgICAgY29uc3QgZ2V0QWxsUmVxdWVzdCA9IHN0b3JlLmdldEFsbCgpOwogICAgICAgICAgICBjb25zdCBwID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7CiAgICAgICAgICAgICAgZ2V0QWxsUmVxdWVzdC5vbnN1Y2Nlc3MgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXVtzdG9yZU5hbWVdID0gc2FuaXRpemVEYXRhKGdldEFsbFJlcXVlc3QucmVzdWx0LCAxMDAwLCAxMDApOwogICAgICAgICAgICAgICAgcmVzKCk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBnZXRBbGxSZXF1ZXN0Lm9uZXJyb3IgPSAoKSA9PiByZWooZ2V0QWxsUmVxdWVzdC5lcnJvcik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzdG9yZVByb21pc2VzLnB1c2gocCk7CiAgICAgICAgICB9CiAgICAgICAgICBQcm9taXNlLmFsbChzdG9yZVByb21pc2VzKS50aGVuKCgpID0+IHJlc29sdmUoKSk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgcmVzdWx0LmNhY2hlcyA9IHt9OwogICAgY29uc3QgY2FjaGVOYW1lcyA9IGF3YWl0IGNhY2hlcy5rZXlzKCk7CiAgICBmb3IgKGNvbnN0IGNhY2hlTmFtZSBvZiBjYWNoZU5hbWVzKSB7CiAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgY2FjaGVzLm9wZW4oY2FjaGVOYW1lKTsKICAgICAgY29uc3QgcmVxdWVzdHMgPSBhd2FpdCBjYWNoZS5rZXlzKCk7CiAgICAgIHJlc3VsdC5jYWNoZXNbY2FjaGVOYW1lXSA9IFtdOwogICAgICBmb3IgKGNvbnN0IHJlcSBvZiByZXF1ZXN0cykgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FjaGUubWF0Y2gocmVxKTsKICAgICAgICBpZiAoIXJlc3BvbnNlKSBjb250aW51ZTsKICAgICAgICBjb25zdCBjbG9uZWQgPSByZXNwb25zZS5jbG9uZSgpOwogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY2xvbmVkLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKSB8fCAnJzsKICAgICAgICBsZXQgYm9keTsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi9qc29uJykpIHsKICAgICAgICAgICAgYm9keSA9IGF3YWl0IGNsb25lZC5qc29uKCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKCd0ZXh0JykgfHwgY29udGVudFR5cGUuaW5jbHVkZXMoJ2phdmFzY3JpcHQnKSkgewogICAgICAgICAgICBib2R5ID0gYXdhaXQgY2xvbmVkLnRleHQoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNsb25lZC5hcnJheUJ1ZmZlcigpOwogICAgICAgICAgICBib2R5ID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLm5ldyBVaW50OEFycmF5KGJ1ZmZlcikpKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBib2R5ID0gJ1tVbmFibGUgdG8gcmVhZCBib2R5XSc7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5jYWNoZXNbY2FjaGVOYW1lXS5wdXNoKHsKICAgICAgICAgIHVybDogcmVxLnVybCwKICAgICAgICAgIGJvZHksCiAgICAgICAgICBjb250ZW50VHlwZQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgCiAgICBhbGVydCgiRG9uZSwgd2FpdCBmb3IgdGhlIGRvd25sb2FkIHRvIGNvbWUiKTsKICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShyZXN1bHQpXSwgewogICAgICAgIHR5cGU6ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iCiAgICB9KSk7CiAgICBsaW5rLmRvd25sb2FkID0gYCR7RGF0ZS5ub3coKX0uZGF0YWA7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgbGluay5jbGljaygpOwogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICB9CiAgCiAgYXN5bmMgZnVuY3Rpb24gbG9hZERhdGEoZXZlbnQpIHsKICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07CiAgICBpZiAoIWZpbGUpIHJldHVybjsKICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICByZWFkZXIub25sb2FkID0gYXN5bmMgZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShlLnRhcmdldC5yZXN1bHQpOwogICAgICAgIGlmIChkYXRhLmNvb2tpZXMpIHsKICAgICAgICAgICAgZGF0YS5jb29raWVzLnNwbGl0KCc7JykuZm9yRWFjaChjb29raWUgPT4gewogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZS50cmltKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgaWYgKGRhdGEubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhLmxvY2FsU3RvcmFnZVtrZXldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgaWYgKGRhdGEuc2Vzc2lvblN0b3JhZ2UpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YS5zZXNzaW9uU3RvcmFnZSkgewogICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhLnNlc3Npb25TdG9yYWdlW2tleV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICBpZiAoZGF0YS5pbmRleGVkREIpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBkYk5hbWUgaW4gZGF0YS5pbmRleGVkREIpIHsKICAgICAgICAgICAgICBjb25zdCBzdG9yZXMgPSBkYXRhLmluZGV4ZWREQltkYk5hbWVdOwogICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUsIDEpOwogICAgICAgICAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBlID0+IHsKICAgICAgICAgICAgICAgICAgY29uc3QgZGIgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3RvcmVOYW1lIGluIHN0b3JlcykgewogICAgICAgICAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhzdG9yZU5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShzdG9yZU5hbWUsIHsga2V5UGF0aDogJ2lkJywgYXV0b0luY3JlbWVudDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGUgPT4gewogICAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihPYmplY3Qua2V5cyhzdG9yZXMpLCAncmVhZHdyaXRlJyk7CiAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uZXJyb3IgPSAoKSA9PiByZWplY3QodHJhbnNhY3Rpb24uZXJyb3IpOwogICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1N0b3JlcyA9IE9iamVjdC5rZXlzKHN0b3JlcykubGVuZ3RoOwogICAgICAgIAogICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN0b3JlTmFtZSBpbiBzdG9yZXMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmUuY2xlYXIoKS5vbnN1Y2Nlc3MgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RvcmVzW3N0b3JlTmFtZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmUucHV0KGl0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1N0b3Jlcy0tOwogICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdTdG9yZXMgPT09IDApIHJlc29sdmUoKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcXVlc3QuZXJyb3IpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICBpZiAoZGF0YS5jYWNoZXMpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBjYWNoZU5hbWUgaW4gZGF0YS5jYWNoZXMpIHsKICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IGF3YWl0IGNhY2hlcy5vcGVuKGNhY2hlTmFtZSk7CiAgICAgICAgICAgICAgYXdhaXQgY2FjaGUua2V5cygpLnRoZW4oa2V5cyA9PiBQcm9taXNlLmFsbChrZXlzLm1hcChrID0+IGNhY2hlLmRlbGV0ZShrKSkpKTsgLy8gY2xlYXIgZXhpc3RpbmcKICAgICAgICAKICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRhdGEuY2FjaGVzW2NhY2hlTmFtZV0pIHsKICAgICAgICAgICAgICAgIGxldCByZXNwb25zZUJvZHk7CiAgICAgICAgICAgICAgICBpZiAoZW50cnkuY29udGVudFR5cGUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkgewogICAgICAgICAgICAgICAgICByZXNwb25zZUJvZHkgPSBKU09OLnN0cmluZ2lmeShlbnRyeS5ib2R5KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW50cnkuY29udGVudFR5cGUuaW5jbHVkZXMoJ3RleHQnKSB8fCBlbnRyeS5jb250ZW50VHlwZS5pbmNsdWRlcygnamF2YXNjcmlwdCcpKSB7CiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlQm9keSA9IGVudHJ5LmJvZHk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zdCBiaW5hcnlTdHIgPSBhdG9iKGVudHJ5LmJvZHkpOwogICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBiaW5hcnlTdHIubGVuZ3RoOwogICAgICAgICAgICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGxlbik7CiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0ci5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlQm9keSA9IGJ5dGVzLmJ1ZmZlcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh7ICdjb250ZW50LXR5cGUnOiBlbnRyeS5jb250ZW50VHlwZSB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKHJlc3BvbnNlQm9keSwgeyBoZWFkZXJzIH0pOwogICAgICAgICAgICAgICAgYXdhaXQgY2FjaGUucHV0KGVudHJ5LnVybCwgcmVzcG9uc2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIGFsZXJ0KCJEYXRhIGxvYWRlZCIpOwogICAgfTsKICAgIGFsZXJ0KCJUaGlzIG1pZ2h0IHRha2UgYSB3aGlsZSwgZG9udCB0b3VjaCBhbnl0aGluZyBvdGhlciB0aGFuIHRoaXMgT0sgYnV0dG9uIik7CiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICB9CgpmdW5jdGlvbiBkYXJrTW9kZSgpIHsKICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgiZGFyay1tb2RlIik7Cn0KCmZ1bmN0aW9uIGNsb2FrSWNvbih1cmwpIHsKICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJsaW5rW3JlbH49J2ljb24nXSIpOwogICAgbGluay5yZWwgPSAiaWNvbiI7CiAgICBpZiAoKHVybCsiIikudHJpbSgpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGxpbmsuaHJlZiA9ICJmYXZpY29uLnBuZyI7CiAgICB9IGVsc2UgewogICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgIH0KICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobGluayk7Cn0KZnVuY3Rpb24gY2xvYWtOYW1lKHN0cmluZykgewogICAgaWYgKChzdHJpbmcrIiIpLnRyaW0oKS5sZW5ndGggPT09IDApIHsKICAgICAgICBkb2N1bWVudC50aXRsZSA9ICJnbi1tYXRoIjsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBkb2N1bWVudC50aXRsZSA9IHN0cmluZzsKfQoKZnVuY3Rpb24gdGFiQ2xvYWsoKSB7CiAgICBjbG9zZVBvcHVwKCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBUaXRsZScpLnRleHRDb250ZW50ID0gIlRhYiBDbG9hayI7CiAgICBjb25zdCBwb3B1cEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBCb2R5Jyk7CiAgICBwb3B1cEJvZHkuaW5uZXJIVE1MID0gYAogICAgICAgIDxsYWJlbCBmb3I9InRhYi1jbG9hay10ZXh0Ym94IiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Ij5TZXQgVGFiIFRpdGxlOjwvbGFiZWw+PGJyPgogICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0idGFiLWNsb2FrLXRleHRib3giIHBsYWNlaG9sZGVyPSJFbnRlciBuZXcgdGFiIG5hbWUuLi4iIG9uaW5wdXQ9ImNsb2FrTmFtZSh0aGlzLnZhbHVlKSI+CiAgICAgICAgPGJyPjxicj48YnI+PGJyPgogICAgICAgIDxsYWJlbCBmb3I9InRhYi1jbG9hay10ZXh0Ym94IiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Ij5TZXQgVGFiIEljb246PC9sYWJlbD48YnI+CiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ0YWItY2xvYWstdGV4dGJveCIgcGxhY2Vob2xkZXI9IkVudGVyIG5ldyB0YWIgaWNvbi4uLiIgb25pbnB1dD0nY2xvYWtJY29uKHRoaXMudmFsdWUpJz4KICAgICAgICA8YnI+PGJyPjxicj4KICAgIGA7CiAgICBwb3B1cEJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKfQoKY29uc3Qgc2V0dGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3MnKTsKc2V0dGluZ3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBUaXRsZScpLnRleHRDb250ZW50ID0gIlNldHRpbmdzIjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgCiAgICA8YnV0dG9uIGNsYXNzPSJzZXR0aW5ncy1idXR0b24iIG9uY2xpY2s9ImRhcmtNb2RlKCkiPlRvZ2dsZSBEYXJrIE1vZGU8L2J1dHRvbj4KICAgIDxicj48YnI+CiAgICA8YnV0dG9uIGNsYXNzPSJzZXR0aW5ncy1idXR0b24iIG9uY2xpY2s9InRhYkNsb2FrKCkiPlRhYiBDbG9hazwvYnV0dG9uPgogICAgPGJyPgogICAgYDsKICAgIHBvcHVwQm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwp9KTsKCgpmdW5jdGlvbiBzaG93Q29udGFjdCgpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cFRpdGxlJykudGV4dENvbnRlbnQgPSAiQ29udGFjdCI7CiAgICBjb25zdCBwb3B1cEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBCb2R5Jyk7CiAgICBwb3B1cEJvZHkuaW5uZXJIVE1MID0gYAogICAgPHA+RGlzY29yZDogaHR0cHM6Ly9kaXNjb3JkLmdnL05BRnc0eWtaN248L3A+CiAgICA8cD5FbWFpbDogZ24ubWF0aC5idXNpbmVzc0BnbWFpbC5jb208L3A+YDsKICAgIHBvcHVwQm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwp9CgpmdW5jdGlvbiBsb2FkUHJpdmFjeSgpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cFRpdGxlJykudGV4dENvbnRlbnQgPSAiUHJpdmFjeSBQb2xpY3kiOwogICAgY29uc3QgcG9wdXBCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwQm9keScpOwogICAgcG9wdXBCb2R5LmlubmVySFRNTCA9IGAKICAgICAgICA8ZGl2IHN0eWxlPSJtYXgtaGVpZ2h0OiA2MHZoOyBvdmVyZmxvdy15OiBhdXRvOyI+CiAgICAgICAgICAgIDxoMj5QUklWQUNZIFBPTElDWTwvaDI+CiAgICAgICAgICAgIDxwPkxhc3QgdXBkYXRlZCBBcHJpbCAxNywgMjAyNTwvcD4KICAgICAgICAgICAgPHA+VGhpcyBQcml2YWN5IE5vdGljZSBmb3IgZ24tbWF0aCAoIndlLCIgInVzLCIgb3IgIm91ciIpLCBkZXNjcmliZXMgaG93IGFuZCB3aHkgd2UgbWlnaHQgYWNjZXNzLCBjb2xsZWN0LCBzdG9yZSwgdXNlLCBhbmQvb3Igc2hhcmUgKCJwcm9jZXNzIikgeW91ciBwZXJzb25hbCBpbmZvcm1hdGlvbiB3aGVuIHlvdSB1c2Ugb3VyIHNlcnZpY2VzICgiU2VydmljZXMiKSwgaW5jbHVkaW5nIHdoZW4geW91OjwvcD4KICAgICAgICAgICAgPHVsPgogICAgICAgICAgICAgICAgPGxpPlZpc2l0IG91ciB3ZWJzaXRlIGF0IDxhIGhyZWY9Imh0dHBzOi8vZ24tbWF0aC5naXRodWIuaW8iPmh0dHBzOi8vZ24tbWF0aC5naXRodWIuaW88L2E+LCBvciBhbnkgd2Vic2l0ZSBvZiBvdXJzIHRoYXQgbGlua3MgdG8gdGhpcyBQcml2YWN5IE5vdGljZTwvbGk+CiAgICAgICAgICAgICAgICA8bGk+RW5nYWdlIHdpdGggdXMgaW4gb3RoZXIgcmVsYXRlZCB3YXlzLCBpbmNsdWRpbmcgYW55IHNhbGVzLCBtYXJrZXRpbmcsIG9yIGV2ZW50czwvbGk+CiAgICAgICAgICAgIDwvdWw+CiAgICAgICAgICAgIDxwPlF1ZXN0aW9ucyBvciBjb25jZXJucz8gUmVhZGluZyB0aGlzIFByaXZhY3kgTm90aWNlIHdpbGwgaGVscCB5b3UgdW5kZXJzdGFuZCB5b3VyIHByaXZhY3kgcmlnaHRzIGFuZCBjaG9pY2VzLiBXZSBhcmUgcmVzcG9uc2libGUgZm9yIG1ha2luZyBkZWNpc2lvbnMgYWJvdXQgaG93IHlvdXIgcGVyc29uYWwgaW5mb3JtYXRpb24gaXMgcHJvY2Vzc2VkLiBJZiB5b3UgZG8gbm90IGFncmVlIHdpdGggb3VyIHBvbGljaWVzIGFuZCBwcmFjdGljZXMsIHBsZWFzZSBkbyBub3QgdXNlIG91ciBTZXJ2aWNlcy4gSWYgeW91IHN0aWxsIGhhdmUgYW55IHF1ZXN0aW9ucyBvciBjb25jZXJucywgcGxlYXNlIGNvbnRhY3QgdXMgYXQgPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkLmdnL05BRnc0eWtaN24iPmh0dHBzOi8vZGlzY29yZC5nZy9OQUZ3NHlrWjduPC9hPi48L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8aDM+U1VNTUFSWSBPRiBLRVkgUE9JTlRTPC9oMz4KICAgICAgICAgICAgPHA+VGhpcyBzdW1tYXJ5IHByb3ZpZGVzIGtleSBwb2ludHMgZnJvbSBvdXIgUHJpdmFjeSBOb3RpY2UsIGJ1dCB5b3UgY2FuIGZpbmQgb3V0IG1vcmUgZGV0YWlscyBhYm91dCBhbnkgb2YgdGhlc2UgdG9waWNzIGJ5IGNsaWNraW5nIHRoZSBsaW5rIGZvbGxvd2luZyBlYWNoIGtleSBwb2ludCBvciBieSB1c2luZyBvdXIgdGFibGUgb2YgY29udGVudHMgYmVsb3cgdG8gZmluZCB0aGUgc2VjdGlvbiB5b3UgYXJlIGxvb2tpbmcgZm9yLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+V2hhdCBwZXJzb25hbCBpbmZvcm1hdGlvbiBkbyB3ZSBwcm9jZXNzPzwvc3Ryb25nPiBXaGVuIHlvdSB2aXNpdCwgdXNlLCBvciBuYXZpZ2F0ZSBvdXIgU2VydmljZXMsIHdlIG1heSBwcm9jZXNzIHBlcnNvbmFsIGluZm9ybWF0aW9uIGRlcGVuZGluZyBvbiBob3cgeW91IGludGVyYWN0IHdpdGggdXMgYW5kIHRoZSBTZXJ2aWNlcywgdGhlIGNob2ljZXMgeW91IG1ha2UsIGFuZCB0aGUgcHJvZHVjdHMgYW5kIGZlYXR1cmVzIHlvdSB1c2UuIExlYXJuIG1vcmUgYWJvdXQgcGVyc29uYWwgaW5mb3JtYXRpb24geW91IGRpc2Nsb3NlIHRvIHVzLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+RG8gd2UgcHJvY2VzcyBhbnkgc2Vuc2l0aXZlIHBlcnNvbmFsIGluZm9ybWF0aW9uPzwvc3Ryb25nPiBTb21lIG9mIHRoZSBpbmZvcm1hdGlvbiBtYXkgYmUgY29uc2lkZXJlZCAic3BlY2lhbCIgb3IgInNlbnNpdGl2ZSIgaW4gY2VydGFpbiBqdXJpc2RpY3Rpb25zLCBmb3IgZXhhbXBsZSB5b3VyIHJhY2lhbCBvciBldGhuaWMgb3JpZ2lucywgc2V4dWFsIG9yaWVudGF0aW9uLCBhbmQgcmVsaWdpb3VzIGJlbGllZnMuIFdlIGRvIG5vdCBwcm9jZXNzIHNlbnNpdGl2ZSBwZXJzb25hbCBpbmZvcm1hdGlvbi48L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8cD48c3Ryb25nPkRvIHdlIGNvbGxlY3QgYW55IGluZm9ybWF0aW9uIGZyb20gdGhpcmQgcGFydGllcz88L3N0cm9uZz4gV2UgZG8gbm90IGNvbGxlY3QgYW55IGluZm9ybWF0aW9uIGZyb20gdGhpcmQgcGFydGllcy48L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8cD48c3Ryb25nPkhvdyBkbyB3ZSBwcm9jZXNzIHlvdXIgaW5mb3JtYXRpb24/PC9zdHJvbmc+IFdlIHByb2Nlc3MgeW91ciBpbmZvcm1hdGlvbiB0byBwcm92aWRlLCBpbXByb3ZlLCBhbmQgYWRtaW5pc3RlciBvdXIgU2VydmljZXMsIGNvbW11bmljYXRlIHdpdGggeW91LCBmb3Igc2VjdXJpdHkgYW5kIGZyYXVkIHByZXZlbnRpb24sIGFuZCB0byBjb21wbHkgd2l0aCBsYXcuIFdlIG1heSBhbHNvIHByb2Nlc3MgeW91ciBpbmZvcm1hdGlvbiBmb3Igb3RoZXIgcHVycG9zZXMgd2l0aCB5b3VyIGNvbnNlbnQuIFdlIHByb2Nlc3MgeW91ciBpbmZvcm1hdGlvbiBvbmx5IHdoZW4gd2UgaGF2ZSBhIHZhbGlkIGxlZ2FsIHJlYXNvbiB0byBkbyBzby4gTGVhcm4gbW9yZSBhYm91dCBob3cgd2UgcHJvY2VzcyB5b3VyIGluZm9ybWF0aW9uLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+SW4gd2hhdCBzaXR1YXRpb25zIGFuZCB3aXRoIHdoaWNoIHBhcnRpZXMgZG8gd2Ugc2hhcmUgcGVyc29uYWwgaW5mb3JtYXRpb24/PC9zdHJvbmc+IFdlIG1heSBzaGFyZSBpbmZvcm1hdGlvbiBpbiBzcGVjaWZpYyBzaXR1YXRpb25zIGFuZCB3aXRoIHNwZWNpZmljIHRoaXJkIHBhcnRpZXMuIExlYXJuIG1vcmUgYWJvdXQgd2hlbiBhbmQgd2l0aCB3aG9tIHdlIHNoYXJlIHlvdXIgcGVyc29uYWwgaW5mb3JtYXRpb24uPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5Ib3cgZG8gd2Uga2VlcCB5b3VyIGluZm9ybWF0aW9uIHNhZmU/PC9zdHJvbmc+IFdlIGhhdmUgYWRlcXVhdGUgb3JnYW5pemF0aW9uYWwgYW5kIHRlY2huaWNhbCBwcm9jZXNzZXMgYW5kIHByb2NlZHVyZXMgaW4gcGxhY2UgdG8gcHJvdGVjdCB5b3VyIHBlcnNvbmFsIGluZm9ybWF0aW9uLiBIb3dldmVyLCBubyBlbGVjdHJvbmljIHRyYW5zbWlzc2lvbiBvdmVyIHRoZSBpbnRlcm5ldCBvciBpbmZvcm1hdGlvbiBzdG9yYWdlIHRlY2hub2xvZ3kgY2FuIGJlIGd1YXJhbnRlZWQgdG8gYmUgMTAwJSBzZWN1cmUsIHNvIHdlIGNhbm5vdCBwcm9taXNlIG9yIGd1YXJhbnRlZSB0aGF0IGhhY2tlcnMsIGN5YmVyY3JpbWluYWxzLCBvciBvdGhlciB1bmF1dGhvcml6ZWQgdGhpcmQgcGFydGllcyB3aWxsIG5vdCBiZSBhYmxlIHRvIGRlZmVhdCBvdXIgc2VjdXJpdHkgYW5kIGltcHJvcGVybHkgY29sbGVjdCwgYWNjZXNzLCBzdGVhbCwgb3IgbW9kaWZ5IHlvdXIgaW5mb3JtYXRpb24uIExlYXJuIG1vcmUgYWJvdXQgaG93IHdlIGtlZXAgeW91ciBpbmZvcm1hdGlvbiBzYWZlLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+V2hhdCBhcmUgeW91ciByaWdodHM/PC9zdHJvbmc+IERlcGVuZGluZyBvbiB3aGVyZSB5b3UgYXJlIGxvY2F0ZWQgZ2VvZ3JhcGhpY2FsbHksIHRoZSBhcHBsaWNhYmxlIHByaXZhY3kgbGF3IG1heSBtZWFuIHlvdSBoYXZlIGNlcnRhaW4gcmlnaHRzIHJlZ2FyZGluZyB5b3VyIHBlcnNvbmFsIGluZm9ybWF0aW9uLiBMZWFybiBtb3JlIGFib3V0IHlvdXIgcHJpdmFjeSByaWdodHMuPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5Ib3cgZG8geW91IGV4ZXJjaXNlIHlvdXIgcmlnaHRzPzwvc3Ryb25nPiBUaGUgZWFzaWVzdCB3YXkgdG8gZXhlcmNpc2UgeW91ciByaWdodHMgaXMgYnkgc3VibWl0dGluZyBhIGRhdGEgc3ViamVjdCBhY2Nlc3MgcmVxdWVzdCwgb3IgYnkgY29udGFjdGluZyB1cy4gV2Ugd2lsbCBjb25zaWRlciBhbmQgYWN0IHVwb24gYW55IHJlcXVlc3QgaW4gYWNjb3JkYW5jZSB3aXRoIGFwcGxpY2FibGUgZGF0YSBwcm90ZWN0aW9uIGxhd3MuPC9wPgogICAgICAgIDwvZGl2PgogICAgYDsKICAgIHBvcHVwQm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwp9CgpmdW5jdGlvbiBsb2FkRE1DQSgpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cFRpdGxlJykudGV4dENvbnRlbnQgPSAiRE1DQSI7CiAgICBjb25zdCBwb3B1cEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBCb2R5Jyk7CiAgICBwb3B1cEJvZHkuaW5uZXJIVE1MID0gYAogICAgICAgIDxkaXYgY2xhc3M9ImRtY2EtY29udGVudCI+CiAgICAgICAgICAgIDxwPgogICAgICAgICAgICAgICAgSWYgeW91IG93biBvciBkZXZlbG9wZWQgYSBnYW1lIHRoYXQgaXMgb24gPHN0cm9uZz5nbi1tYXRoPC9zdHJvbmc+IAogICAgICAgICAgICAgICAgYW5kIHdvdWxkIGxpa2UgaXQgcmVtb3ZlZCwgcGxlYXNlIGRvIG9uZSBvZiB0aGUgZm9sbG93aW5nOgogICAgICAgICAgICA8L3A+CiAgICAgICAgICAgIDxvbD4KICAgICAgICAgICAgICAgIDxsaT4KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL2Rpc2NvcmQuZ2cvRDRjOVZGWVd5VSIgdGFyZ2V0PSJfYmxhbmsiIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIEpvaW4gdGhlIERpc2NvcmQKICAgICAgICAgICAgICAgICAgICA8L2E+IGFuZCBETSA8c3Ryb25nPmJyZWFkYmI8L3N0cm9uZz4gb3IgcGluZyBtZSBpbiBhIHB1YmxpYyBjaGFubmVsIAogICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+W0lOU1RBTlQgUkVTUE9OU0VdPC9zdHJvbmc+CiAgICAgICAgICAgICAgICA8L2xpPgogICAgICAgICAgICAgICAgPGxpPgogICAgICAgICAgICAgICAgICAgIEVtYWlsIG1lIGF0IAogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Im1haWx0bzpnbi5tYXRoLmJ1c2luZXNzQGdtYWlsLmNvbSI+Z24ubWF0aC5idXNpbmVzc0BnbWFpbC5jb208L2E+IAogICAgICAgICAgICAgICAgICAgIHdpdGggdGhlIHN1YmplY3Qgc3RhcnRpbmcgd2l0aCA8Y29kZT4hRE1DQTwvY29kZT4uCiAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5bREVMQVlFRCBSRVNQT05TRV08L3N0cm9uZz4KICAgICAgICAgICAgICAgIDwvbGk+CiAgICAgICAgICAgIDwvb2w+CiAgICAgICAgICAgIDxwPgogICAgICAgICAgICAgICAgSWYgeW91IGFyZSBnb2luZyB0byBkbyBhbiBlbWFpbCwgcGxlYXNlIHNob3cgcHJvb2YgeW91IG93biB0aGUgZ2FtZSBiZWZvcmUgSSBoYXZlIHRvIGFzay4KICAgICAgICAgICAgPC9wPgogICAgICAgIDwvZGl2PgogICAgYDsKICAgIHBvcHVwQm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwp9CgpsZXQgX2FsbFN0YXRzQ2FjaGUgPSBudWxsOwoKYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU3RhdHMoKSB7CiAgaWYgKF9hbGxTdGF0c0NhY2hlKSB7CiAgICByZXR1cm4gX2FsbFN0YXRzQ2FjaGU7CiAgfQoKICBjb25zdCBCQVNFX1VSTCA9CiAgICAiaHR0cHM6Ly9kYXRhLmpzZGVsaXZyLmNvbS92MS9zdGF0cy9wYWNrYWdlcy9naC9nbi1tYXRoL2h0bWxAbWFpbi9maWxlcyI7CiAgY29uc3QgUEVSSU9EID0gInllYXIiOwogIGNvbnN0IFBBR0VfQkFUQ0ggPSA1OwoKICBsZXQgcGFnZSA9IDE7CiAgbGV0IGRvbmUgPSBmYWxzZTsKICBjb25zdCBjb21iaW5lZE1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIHdoaWxlICghZG9uZSkgewogICAgY29uc3QgcGFnZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBQQUdFX0JBVENIIH0sIChfLCBpKSA9PiBwYWdlICsgaSk7CgogICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoCiAgICAgIHBhZ2VzLm1hcChwID0+CiAgICAgICAgZmV0Y2goYCR7QkFTRV9VUkx9P3BlcmlvZD0ke1BFUklPRH0mcGFnZT0ke3B9JmxpbWl0PTEwMGApCiAgICAgICAgICAudGhlbihyID0+IChyLm9rID8gci5qc29uKCkgOiBbXSkpCiAgICAgICkKICAgICk7CgogICAgZm9yIChjb25zdCBkYXRhIG9mIHJlc3BvbnNlcykgewogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkgfHwgZGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICBkb25lID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGRhdGEpIHsKICAgICAgICBpZiAoIWl0ZW0/Lm5hbWUpIGNvbnRpbnVlOwoKICAgICAgICBjb25zdCBtYXRjaCA9IGl0ZW0ubmFtZS5tYXRjaCgvXlwvKFxkKykoWy4tXSkvKTsKICAgICAgICBpZiAoIW1hdGNoKSBjb250aW51ZTsKCiAgICAgICAgY29uc3QgaWQgPSBtYXRjaFsxXTsKCiAgICAgICAgaWYgKCFjb21iaW5lZE1hcFtpZF0pIHsKICAgICAgICAgIGNvbWJpbmVkTWFwW2lkXSA9IHsKICAgICAgICAgICAgaGl0czogMCwKICAgICAgICAgICAgYmFuZHdpZHRoOiAwCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgY29tYmluZWRNYXBbaWRdLmhpdHMgKz0gaXRlbS5oaXRzPy50b3RhbCA/PyAwOwogICAgICAgIGNvbWJpbmVkTWFwW2lkXS5iYW5kd2lkdGggKz0gaXRlbS5iYW5kd2lkdGg/LnRvdGFsID8/IDA7CiAgICAgIH0KICAgIH0KCiAgICBwYWdlICs9IFBBR0VfQkFUQ0g7CiAgfQoKICBfYWxsU3RhdHNDYWNoZSA9IGNvbWJpbmVkTWFwOwogIHJldHVybiBjb21iaW5lZE1hcDsKfQoKYXN5bmMgZnVuY3Rpb24gZ2V0U3RhdHMoaWQpIHsKICBpZCA9IFN0cmluZyhpZCk7CiAgY29uc3QgYWxsU3RhdHMgPSBhd2FpdCBnZXRBbGxTdGF0cygpOwoKICByZXR1cm4gYWxsU3RhdHNbaWRdPy5oaXRzID8/IDA7Cn0KCmZ1bmN0aW9uIHNob3dab25lSW5mbygpIHsKICAgIGxldCBpZCA9IE51bWJlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZUlkJykudGV4dENvbnRlbnQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwVGl0bGUnKS50ZXh0Q29udGVudCA9ICJJbmZvIjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgPHA+TG9hZGluZy4uLjwvcD5gCiAgICBwb3B1cEJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgIGZldGNoKGBodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL2duLW1hdGgvaHRtbC9jb21taXRzP3BhdGg9JHtpZH0uaHRtbGApLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpLnRoZW4oYXN5bmMganNvbiA9PiB7CiAgICAgICAgbGV0IHN0YXRzID0gYXdhaXQgZ2V0U3RhdHMgKGlkKTsKICAgICAgICBpZGpzb24gPSB6b25lcy5maWx0ZXIoYT0+YS5pZD09PWlkKVswXQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cFRpdGxlJykudGV4dENvbnRlbnQgPSBgJHtpZGpzb24ubmFtZX0gSW5mb2A7CiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGpzb24uYXQoLTEpLmNvbW1pdC5hdXRob3IuZGF0ZSk7CiAgICAgICAgbGV0IGZvcm1hdHRlZGRhdGUgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgiZW4tVVMiLCB7CiAgbW9udGg6ICJsb25nIiwKICBkYXk6ICJudW1lcmljIiwKICB5ZWFyOiAibnVtZXJpYyIsCiAgaG91cjogIm51bWVyaWMiLAogIG1pbnV0ZTogIjItZGlnaXQiLAogIGhvdXIxMjogdHJ1ZQp9KS5mb3JtYXQoZGF0ZSk7CiAgICAgICAgcG9wdXBCb2R5LmlubmVySFRNTCA9IGAKICAgICAgICA8cD4KICAgICAgICA8Yj5JZDwvYj46ICR7aWR9PGJyPgogICAgICAgIDxiPk5hbWU8L2I+OiAke2lkanNvbi5uYW1lfTxicj4KICAgICAgICAke2lkanNvbi5hdXRob3I/YDxiPkdhbWUgQXV0aG9yPC9iPjogJHtpZGpzb24uYXV0aG9yfTxicj5gOiIifQogICAgICAgICR7aWRqc29uLmF1dGhvckxpbms/YDxiPkdhbWUgQXV0aG9yIExpbms8L2I+OiA8YSBzdHlsZT0iY29sb3I6I0ZGRkYwMDsiIGhyZWY9JHtpZGpzb24uYXV0aG9yTGlua30+JHtpZGpzb24uYXV0aG9yTGlua308L2E+PGJyPmA6IiJ9CiAgICAgICAgJHtpZGpzb24uc3BlY2lhbD9gPGI+VGFnczwvYj46ICR7aWRqc29uLnNwZWNpYWx9PGJyPmA6IiJ9CiAgICAgICAgPGI+R24tTWF0aCBBZGRlcjwvYj46ICR7anNvbi5hdCgtMSkuY29tbWl0LmF1dGhvci5uYW1lfTxicj4KICAgICAgICA8Yj5EYXRlIEFkZGVkPC9iPjogJHtmb3JtYXR0ZWRkYXRlfTxicj4KICAgICAgICA8Yj5UaW1lcyBQbGF5ZWQgKEdsb2JhbGx5KTwvYj46ICR7TnVtYmVyKHN0YXRzKS50b0xvY2FsZVN0cmluZygiZW4tVVMiKX0KICAgICAgICA8L3A+YDsKICAgIH0pCn0KCmZ1bmN0aW9uIGNsb3NlUG9wdXAoKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKfQpsaXN0Wm9uZXMoKTsKCmNvbnN0IHNjaG9vbExpc3QgPSBbImRlbGVkYW8iLCAiZ29ndWFyZGlhbiIsICJsaWdodHNwZWVkIiwgImxpbmV3aXplIiwgInNlY3VybHkiLCAiLmVkdS8iXTsKCmZ1bmN0aW9uIGlzQmxvY2tlZERvbWFpbih1cmwpIHsKICAgIHRyeSB7CiAgICBjb25zdCBkb21haW4gPSBuZXcgVVJMKHVybCwgbG9jYXRpb24ub3JpZ2luKS5ob3N0bmFtZSArICIvIjsKICAgIHJldHVybiBzY2hvb2xMaXN0LnNvbWUoc2Nob29sID0+IGRvbWFpbi5pbmNsdWRlcyhzY2hvb2wpKTsKICAgIH0gY2F0Y2goZXJyb3Ipe3JldHVybiBmYWxzZTt9Cn0KCmNvbnN0IG9yaWdpbmFsRmV0Y2ggPSB3aW5kb3cuZmV0Y2g7CndpbmRvdy5mZXRjaCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHsKICAgIGlmIChpc0Jsb2NrZWREb21haW4odXJsKSkgewogICAgICAgIGNvbnNvbGUud2FybihgbGFtYCk7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigibGFtIikpOwogICAgfQogICAgcmV0dXJuIG9yaWdpbmFsRmV0Y2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKCmNvbnN0IG9yaWdpbmFsT3BlbiA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOwpYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChtZXRob2QsIHVybCkgewogICAgaWYgKGlzQmxvY2tlZERvbWFpbih1cmwpKSB7CiAgICAgICAgY29uc29sZS53YXJuKGBsYW1gKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICByZXR1cm4gb3JpZ2luYWxPcGVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn07CgpIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUudG9EYXRhVVJMID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHsKICAgIHJldHVybiAiIjsKfTsKPC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCkKICAgICAgICBjb25zdCBwcml2YWN5ID0gc2VhcmNoLmdldCgncHJpdmFjeScpCiAgICAgICAgaWYgKHByaXZhY3kpIHsKICAgICAgICAgIGxvYWRQcml2YWN5KCkKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fQogICAgPC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcihsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0bmFtZSArICcvc3cuanMnKQogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=?id=469
